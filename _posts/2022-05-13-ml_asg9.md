---
title: '[Blog]ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ë¡œ Web app ë§Œë“¤ê¸°'
layout: single
categories:
  - Python
tag:
  - Blog
  - machinelearning
  - assignment
toc: true
toc_label: "on this page"
toc_sticky: true
---
# ML ëª¨ë¸ ì‚¬ìš©í•´ Web app ë§Œë“¤ê¸°

âœ¨ ì•„ë˜ì˜ ëª¨ë“  ë‚´ìš©ì€ [Build a web app to use your ML model](https://github.com/codingalzi/ML-For-Beginners/tree/main/3-Web-App/1-Web-App)ì—ì„œ ë‚´ìš©ì„ í•™ìŠµí•œ í›„ ì›¹ì•±ì„ êµ¬í˜„í•´ ì‘ì„±í•˜ì˜€ìŒì„ ë¯¸ë¦¬ ì•Œë¦½ë‹ˆë‹¤.

âœ¨ ë” ìì„¸í•œ ë‚´ìš©ì€ ìœ„ í•™ìŠµ ì‚¬ì´íŠ¸ë¥¼ ì°¸ì¡°í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.

í•™ìŠµí•  ìˆ˜ ìˆëŠ” ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- í›ˆë ¨ëœ ëª¨ë¸ì„ `pickle`í•˜ëŠ” ë°©ë²•
- __Flask__ ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

## ê³ ë ¤ì‚¬í•­
âœ… ëª¨ë°”ì¼ ì•±ì„ ë§Œë“¤ê±°ë‚˜ IoT ì»¨í…ìŠ¤íŠ¸ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼ ë˜ëŠ” ê²½ìš°, TensorFlow Liteë¡œ Android ë˜ëŠ” iOS ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

âœ… ì˜¤í”„ë¼ì¸ìœ¼ë¡œë„ ì•±ì´ ì‘ë™í•œë‹¤.

âœ… ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¬ ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ  (ì„ íƒëœ ê¸°ìˆ ì€ ì‚¬ìš©í•  ë„êµ¬ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤.)
- Tensor flow
- PyTorch
- Lobe.ai ë˜ëŠ” Azure Custom vision

âœ… ê°„ë‹¨í•˜ê²Œ Flask ì›¹ ì•±ì„ ë§Œë“¤ì–´ í›ˆë ¨ëœ ëª¨ë¸ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.  
(JavaScript ì»¨í…ìŠ¤íŠ¸ì—ì„œ TensorFlow.jsë¡œ ë§ˆë¬´ë¦¬ ì§€ì„ ìˆ˜ ìˆìŒ)

ìš°ë¦¬ëŠ” Python ê¸°ë°˜ì˜ ë…¸íŠ¸ë¶(íŒŒì¼)ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ìœ¼ë¯€ë¡œ íŒŒì´ì¬ìœ¼ë¡œ ì œì‘ëœ ë…¸íŠ¸ë¶ì—ì„œ í›ˆë ¨ëœ ëª¨ë¸ì„ ì›¹ ì•±ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í¬ë§·ìœ¼ë¡œ ë‚´ë³´ë‚¼ ë•Œ í•„ìš”í•œ ë‹¨ê³„ë¥¼ ì•Œì•„ë´ì•¼í•œë‹¤.

## ë„êµ¬
ìš°ë¦¬ê°€ ì‚¬ìš©í•  2ê°€ì§€ ë„êµ¬ë¥¼ ì†Œê°œí•œë‹¤.

âœ… __[Flask](https://palletsprojects.com/p/flask/)__
- 'micro-framework'ë¡œ ì •ì˜ëœ FlaskëŠ” íŒŒì´ì¬ìœ¼ë¡œ ì›¹ í”„ë ˆì„ ì›Œí¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥ê³¼ ì›¹ í˜ì´ì§€ë¥¼ ë§Œë“œëŠ” í…œí”Œë¦¿ ì—”ì§„ì„ ì œê³µí•œë‹¤.
- [ì—°ìŠµ ì‚¬ì´íŠ¸](https://docs.microsoft.com/learn/modules/python-flask-build-ai-web-app?WT.mc_id=academic-15963-cxa)

âœ… __[Pickle](https://docs.python.org/3/library/pickle.html)__
- Python ê°ì²´ êµ¬ì¡°ë¥¼ serializes(ì§ë ¬í™”)ì™€ de-serializes(ë¹„ì§ë ¬í™”)í•˜ëŠ” Python ëª¨ë“ˆ
- ëª¨ë¸ì„ ì›¹ì—ì„œ ì“°ê¸° ìœ„í•´ì„œ serialize ë˜ëŠ” flattení•œë‹¤. (ë‹¨ì¡°ë¡­ê²Œ í•œë‹¤)
- â—pickleì€ ì›ë˜ ì•ˆì „í•˜ì§€ ì•Šì•„ì„œ, íŒŒì¼ì„ 'un-pickle'í•œë‹¤ê³  ë‚˜ì˜¤ë©´ ì£¼ì˜í•´ì•¼í•œë‹¤.
- í™•ì¥ì ì´ë¦„ì€`.pkl`ì´ë‹¤.

## ì—°ìŠµ

__âœ ë°ì´í„° ì •ë¦¬í•˜ê¸°__

[NUFORC](https://nuforc.org/) (The National UFO Reporting Center)ì—ì„œ ëª¨ì•„ë‘” 80,000 ê°œì˜ UFO ëª©ê²© ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤.  
ë°ì´í„°ì— UFOëª©ê²© ê´€ë ¨í•´ ì„¤ëª…ì´ ìˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ë‹¤.
- ê¸´ ì˜ˆì‹œ : "A man emerges from a beam of light that shines on a grassy field at night and he runs towards the Texas Instruments parking lot"  
("ë°¤ì— ì”ë””ë°­ì„ ë¹„ì¶”ëŠ” ë¹›ì¤„ê¸°ì—ì„œ í•œ ë‚¨ìê°€ ë‚˜íƒ€ë‚˜ Texas Instruments ì£¼ì°¨ì¥ì„ í–¥í•´ ë‹¬ë ¤ê°”ë‹¤.")
- ì§§ì€ ì˜ˆì‹œ : "the lights chased us"  
("ë¹›ì´ ìš°ë¦¬ë¥¼ ì«“ì•„ì™”ë‹¤")


[ufos.csv](https://github.com/codingalzi/ML-For-Beginners/blob/main/3-Web-App/1-Web-App/data/ufos.csv) ì—ëŠ” ëª©ê²©ëœ `city`(ë„ì‹œ), `state`(ì£¼) ì™€ `country`(ë‚˜ë¼), ë°œê²¬ë¬¼ì²´ì˜ `shape`(í˜•íƒœ) ì™€ `latitude`(ìœ„ë„) ë° `longitude`(ê²½ë„) ì—´ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.


```python
import pandas as pd
import numpy as np

# ufos.csvê°€ ìˆëŠ” ìœ„ì¹˜ë¥¼ ì…ë ¥í•´ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤
ufos = pd.read_csv('ufos.csv')
ufos.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>city</th>
      <th>state</th>
      <th>country</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>duration (hours/min)</th>
      <th>comments</th>
      <th>date posted</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>san marcos</td>
      <td>tx</td>
      <td>us</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>45 minutes</td>
      <td>This event took place in early fall around 194...</td>
      <td>4/27/2004</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>lackland afb</td>
      <td>tx</td>
      <td>NaN</td>
      <td>light</td>
      <td>7200.0</td>
      <td>1-2 hrs</td>
      <td>1949 Lackland AFB&amp;#44 TX.  Lights racing acros...</td>
      <td>12/16/2005</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>chester (uk/england)</td>
      <td>NaN</td>
      <td>gb</td>
      <td>circle</td>
      <td>20.0</td>
      <td>20 seconds</td>
      <td>Green/Orange circular disc over Chester&amp;#44 En...</td>
      <td>1/21/2008</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>edna</td>
      <td>tx</td>
      <td>us</td>
      <td>circle</td>
      <td>20.0</td>
      <td>1/2 hour</td>
      <td>My older brother and twin sister were leaving ...</td>
      <td>1/17/2004</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>kaneohe</td>
      <td>hi</td>
      <td>us</td>
      <td>light</td>
      <td>900.0</td>
      <td>15 minutes</td>
      <td>AS a Marine 1st Lt. flying an FJ4B fighter/att...</td>
      <td>1/22/2004</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>




```python
# ufosë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì˜ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤.
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

# Countryë¼ëŠ” í•„ë“œê°€ í•˜ë‚˜ì¸ì§€ í™•ì¸í•´ë³¸ë‹¤.
ufos.Country.unique()
```




    array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)



ë‹¤ìŒ ë‘ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì²˜ë¦¬í•  ë°ì´í„°ì˜ ìˆ˜ë¥¼ ì¤„ì¼ ê²ƒì´ë‹¤.
- nullì¸ ê°’ì„ drop
- 1~60ì´ˆ ë™ì•ˆ ëª©ê²©ëœ ë°ì´í„°ë§Œ ê°€ì ¸ì˜´


```python
# 1. nullì¸ ê°’ì„ dropí•˜ê³  
ufos.dropna(inplace=True)

# 2. 1~60ì´ˆ ë™ì•ˆ ëª©ê²©ëœ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¨ë‹¤.
ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 25863 entries, 2 to 80330
    Data columns (total 4 columns):
     #   Column     Non-Null Count  Dtype  
    ---  ------     --------------  -----  
     0   Seconds    25863 non-null  float64
     1   Country    25863 non-null  object 
     2   Latitude   25863 non-null  float64
     3   Longitude  25863 non-null  float64
    dtypes: float64(3), object(1)
    memory usage: 1010.3+ KB
    

Scikit-learnì˜ `LabelEncoder` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì™€ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•œë‹¤.

âœ… `LabelEncoder`ëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ ìˆœì„œë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.


```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Seconds</th>
      <th>Country</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>20.0</td>
      <td>3</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.0</td>
      <td>4</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>14</th>
      <td>30.0</td>
      <td>4</td>
      <td>35.823889</td>
      <td>-80.253611</td>
    </tr>
    <tr>
      <th>23</th>
      <td>60.0</td>
      <td>4</td>
      <td>45.582778</td>
      <td>-122.352222</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3.0</td>
      <td>3</td>
      <td>51.783333</td>
      <td>-0.783333</td>
    </tr>
  </tbody>
</table>
</div>



__âœ ëª¨ë¸ ìƒì„±__

ë°ì´í„°ë¥¼ í›ˆë ¨ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ì…‹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨ë¸ì„ í›ˆë ¨í•  ì¤€ë¹„ë¥¼ í•œë‹¤.  

XëŠ” í›ˆë ¨í•  3ê°€ì§€ì˜ íŠ¹ì„±ì´ ë“¤ì–´ê°€ê³ , yëŠ” `Country` íŠ¹ì„±ì„ ë‚˜íƒ€ë‚¸ë‹¤.

ì´ ëª¨ë¸ì€ `Seconds`, `Latitude` ì™€ `Longitude`ë¥¼ ì…ë ¥í•˜ë©´ êµ­ê°€ idë¥¼ ë°˜í™˜í•œë‹¤.


```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```


```python
# logistic íšŒê·€ë¥¼ ì‚¬ìš©í•´ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.
from sklearn.metrics import accuracy_score, classification_report 
from sklearn.linear_model import LogisticRegression

# max_iterë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•˜ì„ ë–ˆ Convergenceê²½ê³ ê°€ ë°œìƒí–ˆë‹¤.
# ì˜¤ë¥˜ê°€ ì•„ë‹Œ ê²½ê³ ì´ì§€ë§Œ ìš°ë¦¬ëŠ” ìµœìƒì˜ ëª¨ë¸ì„ ë§Œë“œëŠ” ê²ƒì´ ëª©í‘œì´ë¯€ë¡œ
# ìš°ë¦¬ëŠ” ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ max_iterë¥¼ ì§€ì •í•œë‹¤.
model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

                  precision    recall  f1-score   support
    
               0       1.00      1.00      1.00        41
               1       0.83      0.23      0.36       250
               2       1.00      1.00      1.00         8
               3       1.00      1.00      1.00       131
               4       0.96      1.00      0.98      4743
    
        accuracy                           0.96      5173
       macro avg       0.96      0.85      0.87      5173
    weighted avg       0.96      0.96      0.95      5173
    
    Predicted labels:  [4 4 4 ... 3 4 4]
    Accuracy:  0.9702300405953992
    

    C:\Users\pc\anaconda3\lib\site-packages\sklearn\linear_model\_logistic.py:814: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      n_iter_i = _check_optimize_result(
    

íŠ¹ì„± `Country` ì™€ `Latitude/Longitude`ê°€ ìƒê´€ ê´€ê³„ì´ê¸° ë•Œë¬¸ì— ì •í™•ë„ëŠ”(ì•½ 97%) ë‚˜ì˜ì§€ ì•Šê²Œ(ì¢‹ê²Œ) ë‚˜ì˜¨ë‹¤.

ì´ ëª¨ë¸ì€ `Latitude`ì™€ `Longitude`ë¥¼ í†µí•´ì„œ `Country`ë¥¼ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§¤ìš° í˜ì‹ ì ì´ì§„ ì•Šì§€ë§Œ, ì¶”ì¶œí•œ ì›ë³¸ ë°ì´í„°ì—ì„œ í›ˆë ¨ì„ í•´ë³´ê³  ì›¹ ì•±ì—ì„œ ëª¨ë¸ì„ ì“°ê¸°ì— ì¢‹ì€ ì—°ìŠµìœ¼ë¡œ ì‚¬ìš©ë˜ê¸° ì¢‹ë‹¤.

## ëª¨ë¸ 'pickle' ë§Œë“¤ê¸°
ëª¨ë¸ì„ ğŸ¥’ _pickle_ í•  ê²ƒì´ë‹¤.(`.pkl`í™•ì¥ìë¡œ ë§Œë“¬)  

ì´ ê³¼ì •ì´ ì™„ë£Œë˜ë©´ pickleëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ ì´ˆ, ìœ„ë„, ê²½ë„ ê°’ì´ í¬í•¨ëœ ë°ì´í„° ìƒ˜í”Œ ë°°ì—´ì„ ëŒ€ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•œë‹¤.


```python
import pickle
# ëª¨ë¸ì„ pickleí•œë‹¤
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

# pickleëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ í…ŒìŠ¤íŠ¸í•œë‹¤.
model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

    [3]
    

    C:\Users\pc\anaconda3\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
      warnings.warn(
    

_ìœ„ë¥¼ ì‹¤í–‰í•˜ë©´ UserWarningì´ ë°œìƒí•˜ì§€ë§Œ ì´ëŠ” ë¬´ì‹œí•´ë„ ëª¨ë¸ í›ˆë ¨ì— í° ì˜í–¥ì´ ê°€ì§€ ì•ŠëŠ”ë‹¤._  
ëª¨ë¸ì´ ê²½ë„ì™€ ìœ„ë„ì— ë”°ë¥¸ êµ­ê°€ ì½”ë“œ 3(ì˜êµ­)ì„ ë°˜í™˜í•¨ì„ ë³¼ ìˆ˜ ìˆë‹¤.

## Flaskë¡œ ì›¹ ì•± ë§Œë“¤ê¸°
Flask ì•±ì„ ë§Œë“¤ì–´ì„œ ëª¨ë¸ì„ ë¶€ë¥´ê³  ëª¨ë¸ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ë„ë¡ í•  ê²ƒì´ë‹¤.  
ì´ëŠ” ëª¨ë¸ì„ ì‹œê°í™”í•œë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

ğŸ“„: íŒŒì¼, ğŸ“: í´ë”

__(1)__ ğŸ“„`ufo-model.pkl`ê³¼ ğŸ“„`notebook.ipynb` ì˜†ì— ğŸ“`web-app`ì„ ë§Œë“ ë‹¤. 

![pic1](/assets/img/mlasg9_1.png)
  
  

__(2)__ ğŸ“`web-app` ì•ˆì— ğŸ“`static`(ë‚´ë¶€ì— ğŸ“`css`)ê³¼ ğŸ“`templates`ì„ ë§Œë“ ë‹¤.

![pic2](/assets/img/mlasg9_2.png)

![pic2_2](/assets/img/mlasg9_2_2.png)


__(3)__ ğŸ“`web-app` ì•ˆì— ğŸ“„`requirements.txt`ì„ ë§Œë“ ë‹¤.  
( JavaScript ì•±ì˜ package.json ì²˜ëŸ¼, ì•±ì— í•„ìš”í•œ ì˜ì¡´ì„±ì„ ë¦¬ìŠ¤íŠ¸í•œ íŒŒì¼ì„)  

![pic8](/assets/img/mlasg9_8.png)

ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```
scikit-learn
pandas
numpy
flask
```

__(4)__ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤.  

ğŸ“`web-app`ìœ¼ë¡œ ì´ë™í•´ íŒŒì¼ì„ ì‹¤í–‰í•  ê²ƒì´ë¼ëŠ” ëª…ë ¹ì´ë‹¤.

```
# cd web-appíŒŒì¼ì´ ì €ì¥ëœ ê²½ë¡œ
cd web-app
```
![pic4](/assets/img/mlasg9_4.png) 
![pic5](/assets/img/mlasg9_5.png)

> ë¹¨ê°„ì¤„ì´ ìˆëŠ” ìœ„ì¹˜ì— ëœ¨ëŠ” ì‚¬ì´íŠ¸ë¥¼ í´ë¦­í•˜ë©´ ê°ìê°€ êµ¬ì¶•í•œ ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

__(5)__ `pip install` ëª…ë ¹ìœ¼ë¡œ `requirements.txt`ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•œë‹¤.
```
pip install -r requirements.txt
```

ì•± ì™„ì„±ì„ ìœ„í•´ 3ê°€ì§€ íŒŒì¼ì„ ë” ë§Œë“¤ì–´ì•¼ í•œë‹¤.  

__(6-1)__  ğŸ“`web-app`ì•ˆì— ğŸ“„`app.py`ë¥¼ ë§Œë“ ë‹¤.


```python
# 1)
import numpy as np
from flask import Flask, request, render_template
import pickle


app = Flask(__name__)

# 2)
model = pickle.load(open("./ufo-model.pkl", "rb"))

# 3)
@app.route("/")
def home():
    return render_template("index.html")

# 4)
@app.route("/predict", methods=["POST"])
def predict():
    # 4-1)
    int_features = [int(x) for x in request.form.values()]
    final_features = [np.array(int_features)]
    prediction = model.predict(final_features)

    output = prediction[0]

    countries = ["Australia", "Canada", "Germany", "UK", "US"]
    
    # 4-2)
    return render_template(
        // "index.html", prediction_text="Likely country: {}".format(countries[output])
        "index.html", prediction_text="Likely country(ì˜ˆì¸¡ëœ êµ­ê°€): {}".format(countries[output])
    )


if __name__ == "__main__":
    app.run(debug=True)
```

1 ) í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“±ì„ ì¶”ê°€í•œ ë‹¤ìŒ ì•±ì´ ì‹œì‘ëœë‹¤.

2 ) ğŸ¥’ pickle ëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.

3 ) `index.html`ì„ í™ˆ ë¼ìš°í„°ë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.

4-1 ) í¼ ë³€ìˆ˜ë¥¼ ëª¨ì•„ì„œ ë„˜íŒŒì´ ë°°ì—´ë¡œ ë³€í™˜í•˜ê³  ì´ë¥¼ ëª¨ë¸ë¡œ ë³´ë‚´ ì˜ˆì¸¡ì„ ë°˜í™˜í•œë‹¤.  
4-2 ) êµ­ê°€ë¥¼ ë³´ì—¬ì¤„ ë•ŒëŠ” ì˜ˆì¸¡ëœ êµ­ê°€ ì½”ë“œë¥¼ ì½ê¸° í¸í•˜ê²Œ í…ìŠ¤íŠ¸ë¡œ ë‹¤ì‹œ ë°”ê¿”ì„œ ë°˜í™˜í•˜ê³  ì´ ê°’ì„ í…œí”Œë¦¿(ì›¹ ì•±)ì—ì„œ ëœë”ë§í•  ìˆ˜ ìˆê²Œ `index.html`ë¡œ ë³´ë‚¸ë‹¤.

__(6-2)__  ğŸ“`templates`ì•ˆì— ğŸ“„`index.html`ë¥¼ ë§Œë“ ë‹¤.

ì›ë˜ì˜ ì‚¬ì´íŠ¸ì—ì„œëŠ” ì•„ë˜ì²˜ëŸ¼ ì½”ë”©í–ˆì§€ë§Œ,

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 
</head>

<body>
 <div class="grid">

  <div class="box">

  <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>

    <form action="{{ url_for('predict')}}" method="post">
    	<input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
      <input type="text" name="latitude" placeholder="Latitude" required="required" />
		  <input type="text" name="longitude" placeholder="Longitude" required="required" />
      <button type="submit" class="btn">Predict country where the UFO is seen</button>
    </form>

  
   <p>{{ prediction_text }}</p>

 </div>
</div>

</body>
</html>

```

ë‚˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì½”ë”©í•˜ì˜€ë‹¤.(ì¡°ê¸ˆ ìˆ˜ì •í•¨)

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸ›¸ UFOê°€ ë‚˜íƒ€ë‚¬ë‹¤!!! ğŸ‘½</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 
</head>

<body>
 <div class="grid">

  <div class="box">

  <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>
  <p>â°ì´ˆ, ğŸ§­ìœ„ë„ì™€ ê²½ë„ì— ë”°ë¼ UFOê°€ ëª©ê²©ë˜ì—ˆë‹¤ê³  ì•Œë ¤ì§„ êµ­ê°€ëŠ” ì–´ë””ì¼ê¹Œ?  </p>

    <form action="{{ url_for('predict')}}"method="post">
    	<input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
      <input type="text" name="latitude" placeholder="Latitude" required="required" />
		  <input type="text" name="longitude" placeholder="Longitude" required="required" />
      <button type="submit" class="btn">ğŸ›¸UFOê°€ ë°œê²¬ëœ êµ­ê°€ë¥¼ ì˜ˆì¸¡í•´ë³´ì !</button>
    </form>

  
   <p>{{ prediction_text }}</p>

 </div>
</div>

</body>
</html>
```


__(6-3)__  ğŸ“`static/css`ì•ˆì— ğŸ“„`styles.css`ë¥¼ ë§Œë“ ë‹¤.


```css
body {
	width: 100%;
	height: 100%;
	font-family: 'Helvetica';
	background: black;
	color: #fff;
	text-align: center;
	letter-spacing: 1.4px;
	font-size: 30px;
}

input {
	min-width: 150px;
}

.grid {
	width: 300px;
	border: 1px solid #2d2d2d;
	display: grid;
	justify-content: center;
	margin: 20px auto;
}

.box {
	color: #fff;
	background: #2d2d2d;
	padding: 12px;
	display: inline-block;
}

```

> ğŸ’¡ debug=Trueë¥¼ ì¶”ê°€í•˜ë©´ Flaskë¥¼ ì‚¬ìš©í•´ì„œ ì›¹ ì•±ì„ ì‹¤í–‰í•˜ëŠ” ë„ì¤‘ì—, ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•  í•„ìš”ì—†ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë³€ê²½ì ì´ ì €ì¥ëœë‹¤. ì£¼ì˜í•  ì ì€ í”„ë¡œë•ì…˜ ì•±ì—ì„œ ì´ ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì§€ ë§ì•„ì•¼í•œë‹¤.

![pic3](/assets/img/mlasg9_3.png)

__(7)__ ì´ì œ ì›¹ ì•± êµ¬ì¶•ì„ ì™„ë£Œí•˜ì˜€ë‹¤.   
í„°ë¯¸ë„ì— `python app.py` ë˜ëŠ” `python3 app.py`ë¼ëŠ” ëª…ë ¹ì„ ë‚´ë¦¬ë©´ ì›¹ ì„œë²„ê°€ ë¡œì»¬ì—ì„œ ì‹œì‘í•˜ê³  ì´ˆ, ìœ„ë„, ê²½ë„ë¥¼ ì…ë ¥í•˜ë©´ UFOê°€ ëª©ê²©ëœ ì¥ì†Œì— ëŒ€í•œ ë‹µì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

![pic6](/assets/img/mlasg9_6.png) 
> ì²˜ìŒ í™”ë©´ì´ë‹¤. ì›¹ ì•±ì´ ì•„ì£¼ ì˜ êµ¬ì¶•ë˜ì—ˆë‹¤.

![pic7](/assets/img/mlasg9_7.png)
> ìš°ë¦¬ê°€ ìœ„ ì—°ìŠµì—ì„œ í™•ì¸í•´ë³¸ ì´ˆ, ìœ„ë„, ê²½ë„(50,44,-12)ë¥¼ ì…ë ¥í–ˆì„ ë•Œ ê°™ì€ ê²°ê³¼(ì—°ìŠµì—ì„œëŠ” êµ­ê°€ì½”ë“œ`3`ì´ ë‚˜ì™”ì§€ë§Œ, ì—¬ê¸°ì„  `UK`ë¼ëŠ” êµ­ê°€ëª…)ê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


`Flask`ì™€ `pickled ëª¨ë¸`ê°™ì´, ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì€ ì–´ë µì§€ ì•Šë‹¤.  
ì–´ë ¤ìš´ ê²ƒì€ ì˜ˆì¸¡ì„ ë°›ê¸° ìœ„í•´ì„œ ëª¨ë¸ì— ì¤„ ë°ì´í„°ì˜ ëª¨ì–‘ì„ ì´í•´í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.  
ëª¨ë“  ëª¨ë¸ì€ í›ˆë ¨ì„ ë”°ë¥¸ë‹¤. ì˜ˆì¸¡ì„ ë°›ê¸° ìœ„í•´ì„œ 3ê°œ ë°ì´í„°ë¥¼ ì…ë ¥í•´ì•¼í•œë‹¤.

ì „ë¬¸ì ì¸ ì¤€ë¹„ê³¼ì •ì—ì„œëŠ” ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ì‚¬ëŒê³¼ ì›¹ ë˜ëŠ” ëª¨ë°”ì¼ ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒ ì‚¬ì´ì—ì‚¬ ì†Œí†µì´ ì–¼ë§ˆë‚˜ í•„ìš”í•˜ê³  ì¤‘ìš”í•œ ì—­í• ì¸ì§€ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.  

## ğŸš€ ë„ì „ê³¼ì œ

ë…¸íŠ¸ë¶ì—ì„œ ë”°ë¡œ `Flask`ì•±ì„ ì‘ì„±í•´ì„œ ëª¨ë¸ì„ ê°€ì ¸ì˜¤ëŠ” ëŒ€ì‹  `Flask`ì•±ì—ì„œ ë°”ë¡œ ëª¨ë¸ì„ í›ˆë ¨í•  ìˆ˜ ìˆë‹¤.

ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ë…¸íŠ¸ë¶ì—ì„œ íŒŒì´ì¬ ì½”ë“œë¡œ ë³€í™˜í•´ì„œ `train`ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ë¼ìš°í„°ë¡œ ëª¨ë¸ì„ í›ˆë ¨í•  ìˆ˜ ìˆë‹¤.

ì´ëŸ° ë°©ì‹ì—ì„œì˜ ì¥ì ê³¼ ë‹¨ì ì€ ë¬´ì—‡ì¼ê¹Œ?

---
ğŸ’– ì•ì„œ ë§í–ˆë“¯ ìœ„ ë‚´ìš©ì€ [Build a web app to use your ML model](https://github.com/codingalzi/ML-For-Beginners/tree/main/3-Web-App/1-Web-App)ì—ì„œ ë‚´ìš©ì„ í•™ìŠµí•œ í›„ ì›¹ì•±ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ì¶”ê°€ì ìœ¼ë¡œ ì„¤ëª…í•˜ë©° ì‘ì„±í•˜ì˜€ìŒì„ ì•Œë¦½ë‹ˆë‹¤.

ğŸ’– ì¶”ê°€í•œ ë‚´ìš©ì´ë‚˜ ì›ë³¸ì„ í™•ì¸í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ ìœ„ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•´ì£¼ì„¸ìš”.
