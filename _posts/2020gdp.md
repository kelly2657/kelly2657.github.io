1인당 GDP와 삶의 만족도 사이의 선형 관계를 예측하는 모델의 훈련과정을 소개한다.

데이터는 2020년 데이터를 사용할 것이다.

## 기본설정


```python
import numpy as np
import pandas as pd
```


```python
# 실행결과를 일정하게 유지하기 위해 사용한다.
np.random.seed(42)
```


```python
# 그래프 출력 설정
import matplotlib.pyplot as plt

plt.rc('font', size=12)
plt.rc('axes', labelsize=14, titlesize=14)
plt.rc('legend', fontsize=12)
plt.rc('xtick', labelsize=10)
plt.rc('ytick', labelsize=10)
```

## 데이터 불러오기
`datapath`에 데이터가 들어있는 주소를 넣어준 후 파일의 종류에 따라 사용하는 메서드를 다르게 하여 파일 내용을 읽어온다.

여기서는 엑셀 파일을 읽을 땐 `read_excel()`, csv파일을 읽을 땐`read_csv()`를 사용했다.


```python
datapath = "https://raw.githubusercontent.com/codingalzi/handson-ml3/master/notebooks/data/lifesat/"
```


```python
# read_excel : read_csv와 다르게 delimiter, encoding키워드가 없음
gdp_per_capita_2020 = pd.read_excel(datapath + "gdp_per_capita_2020.xlsx", 
                             thousands=',',  
                             na_values="n/a")
```


```python
# 190개 국가 1인당 gdp정보 윗줄 5개
gdp_per_capita_2020.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>2020</th>
      <th>Estimates Start After</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>499.441</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albania</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>4898.277</td>
      <td>2018.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Algeria</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>3331.076</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Angola</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>2021.310</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Antigua and Barbuda</td>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>14158.571</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 국가명을 행 인덱스로 지정
gdp_per_capita_2020.set_index("Country",inplace=True)

#열이름 "2020"을 "GDP per capita"로 지정
gdp_per_capita_2020.rename(columns={2020:"GDP per capita"}, inplace=True)

# 변경한 정보 윗줄 5개
gdp_per_capita_2020.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subject Descriptor</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Country/Series-specific Notes</th>
      <th>GDP per capita</th>
      <th>Estimates Start After</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>499.441</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>4898.277</td>
      <td>2018.0</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>3331.076</td>
      <td>2019.0</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>2021.310</td>
      <td>2017.0</td>
    </tr>
    <tr>
      <th>Antigua and Barbuda</th>
      <td>Gross domestic product per capita, current prices</td>
      <td>U.S. dollars</td>
      <td>Units</td>
      <td>See notes for:  Gross domestic product, curren...</td>
      <td>14158.571</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# oecd 파일도 읽어온다.
oecd_bli = pd.read_csv(datapath + "oecd_bli_2020.csv",thousands=',')
```


```python
# oecd 파일의 형태를 알아보자
oecd_bli.shape
```




    (2369, 17)




```python
# oecd 데이터의 앞부분 5개를 살펴보자
oecd_bli.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LOCATION</th>
      <th>Country</th>
      <th>INDICATOR</th>
      <th>Indicator</th>
      <th>MEASURE</th>
      <th>Measure</th>
      <th>INEQUALITY</th>
      <th>Inequality</th>
      <th>Unit Code</th>
      <th>Unit</th>
      <th>PowerCode Code</th>
      <th>PowerCode</th>
      <th>Reference Period Code</th>
      <th>Reference Period</th>
      <th>Value</th>
      <th>Flag Codes</th>
      <th>Flags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AUS</td>
      <td>Australia</td>
      <td>JE_LMIS</td>
      <td>Labour market insecurity</td>
      <td>L</td>
      <td>Value</td>
      <td>TOT</td>
      <td>Total</td>
      <td>PC</td>
      <td>Percentage</td>
      <td>0</td>
      <td>Units</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AUT</td>
      <td>Austria</td>
      <td>JE_LMIS</td>
      <td>Labour market insecurity</td>
      <td>L</td>
      <td>Value</td>
      <td>TOT</td>
      <td>Total</td>
      <td>PC</td>
      <td>Percentage</td>
      <td>0</td>
      <td>Units</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BEL</td>
      <td>Belgium</td>
      <td>JE_LMIS</td>
      <td>Labour market insecurity</td>
      <td>L</td>
      <td>Value</td>
      <td>TOT</td>
      <td>Total</td>
      <td>PC</td>
      <td>Percentage</td>
      <td>0</td>
      <td>Units</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CAN</td>
      <td>Canada</td>
      <td>JE_LMIS</td>
      <td>Labour market insecurity</td>
      <td>L</td>
      <td>Value</td>
      <td>TOT</td>
      <td>Total</td>
      <td>PC</td>
      <td>Percentage</td>
      <td>0</td>
      <td>Units</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CZE</td>
      <td>Czech Republic</td>
      <td>JE_LMIS</td>
      <td>Labour market insecurity</td>
      <td>L</td>
      <td>Value</td>
      <td>TOT</td>
      <td>Total</td>
      <td>PC</td>
      <td>Percentage</td>
      <td>0</td>
      <td>Units</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



## 데이터 전처리
우리는 필요한 데이터만을 가지고 모델을 훈련할 것이다. 

따라서 모델의 전처리 과정으로 데이터를 정리하는 작업이 필요하다.

`unique()`는 데이터에서 중복되지 않은 값을 제공한다.


```python
oecd_bli.Indicator.unique()
```




    array(['Labour market insecurity',
           'Stakeholder engagement for developing regulations',
           'Dwellings without basic facilities', 'Housing expenditure',
           'Feeling safe walking alone at night', 'Rooms per person',
           'Household net adjusted disposable income', 'Household net wealth',
           'Employment rate', 'Long-term unemployment rate',
           'Personal earnings', 'Quality of support network',
           'Educational attainment', 'Student skills', 'Years in education',
           'Air pollution', 'Water quality', 'Voter turnout',
           'Life expectancy', 'Self-reported health', 'Life satisfaction',
           'Homicide rate', 'Employees working very long hours',
           'Time devoted to leisure and personal care'], dtype=object)




```python
oecd_bli.INEQUALITY.unique()
```




    array(['TOT', 'MN', 'WMN', 'HGH', 'LW'], dtype=object)




```python
# 전체인구 대상으로 하는 TOT기준에 포함된 데이터만 추출해 oecd_bli에 저장
oecd_bli = oecd_bli[oecd_bli["INEQUALITY"]=="TOT"]
```


```python
oecd_bli.shape
```




    (911, 17)




```python
# pivot()메서드 활용해 Indicator항목을 열의 인덱스 이름으로 사용.
# 인덱스 열과 행에는 Value 열에 포함된 값을 사용한다.
oecd_bli = oecd_bli.pivot(index="Country", columns="Indicator", values="Value")
```


```python
# 확인
oecd_bli
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Indicator</th>
      <th>Air pollution</th>
      <th>Dwellings without basic facilities</th>
      <th>Educational attainment</th>
      <th>Employees working very long hours</th>
      <th>Employment rate</th>
      <th>Feeling safe walking alone at night</th>
      <th>Homicide rate</th>
      <th>Household net adjusted disposable income</th>
      <th>Household net wealth</th>
      <th>Housing expenditure</th>
      <th>...</th>
      <th>Personal earnings</th>
      <th>Quality of support network</th>
      <th>Rooms per person</th>
      <th>Self-reported health</th>
      <th>Stakeholder engagement for developing regulations</th>
      <th>Student skills</th>
      <th>Time devoted to leisure and personal care</th>
      <th>Voter turnout</th>
      <th>Water quality</th>
      <th>Years in education</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>5.0</td>
      <td>NaN</td>
      <td>81.0</td>
      <td>13.04</td>
      <td>73.0</td>
      <td>63.5</td>
      <td>1.1</td>
      <td>32759.0</td>
      <td>427064.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>49126.0</td>
      <td>95.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>2.7</td>
      <td>502.0</td>
      <td>14.35</td>
      <td>91.0</td>
      <td>93.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>16.0</td>
      <td>0.9</td>
      <td>85.0</td>
      <td>6.66</td>
      <td>72.0</td>
      <td>80.6</td>
      <td>0.5</td>
      <td>33541.0</td>
      <td>308325.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>50349.0</td>
      <td>92.0</td>
      <td>1.6</td>
      <td>70.0</td>
      <td>1.3</td>
      <td>492.0</td>
      <td>14.55</td>
      <td>80.0</td>
      <td>92.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>15.0</td>
      <td>1.9</td>
      <td>77.0</td>
      <td>4.75</td>
      <td>63.0</td>
      <td>70.1</td>
      <td>1.0</td>
      <td>30364.0</td>
      <td>386006.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>49675.0</td>
      <td>91.0</td>
      <td>2.2</td>
      <td>74.0</td>
      <td>2.0</td>
      <td>503.0</td>
      <td>15.70</td>
      <td>89.0</td>
      <td>84.0</td>
      <td>19.3</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>10.0</td>
      <td>6.7</td>
      <td>49.0</td>
      <td>7.13</td>
      <td>61.0</td>
      <td>35.6</td>
      <td>26.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.2</td>
      <td>395.0</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>73.0</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>7.0</td>
      <td>0.2</td>
      <td>91.0</td>
      <td>3.69</td>
      <td>73.0</td>
      <td>82.2</td>
      <td>1.3</td>
      <td>30854.0</td>
      <td>423849.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>47622.0</td>
      <td>93.0</td>
      <td>2.6</td>
      <td>88.0</td>
      <td>2.9</td>
      <td>523.0</td>
      <td>14.56</td>
      <td>68.0</td>
      <td>91.0</td>
      <td>17.3</td>
    </tr>
    <tr>
      <th>Chile</th>
      <td>16.0</td>
      <td>9.4</td>
      <td>65.0</td>
      <td>9.72</td>
      <td>63.0</td>
      <td>47.9</td>
      <td>4.2</td>
      <td>NaN</td>
      <td>100967.0</td>
      <td>18.0</td>
      <td>...</td>
      <td>25879.0</td>
      <td>85.0</td>
      <td>1.2</td>
      <td>57.0</td>
      <td>1.3</td>
      <td>443.0</td>
      <td>NaN</td>
      <td>47.0</td>
      <td>71.0</td>
      <td>17.5</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>10.0</td>
      <td>23.9</td>
      <td>54.0</td>
      <td>26.56</td>
      <td>67.0</td>
      <td>44.4</td>
      <td>24.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>89.0</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>1.4</td>
      <td>410.0</td>
      <td>NaN</td>
      <td>53.0</td>
      <td>75.0</td>
      <td>14.1</td>
    </tr>
    <tr>
      <th>Czech Republic</th>
      <td>20.0</td>
      <td>0.7</td>
      <td>94.0</td>
      <td>5.65</td>
      <td>74.0</td>
      <td>72.3</td>
      <td>0.5</td>
      <td>21453.0</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>...</td>
      <td>25372.0</td>
      <td>91.0</td>
      <td>1.4</td>
      <td>60.0</td>
      <td>1.6</td>
      <td>491.0</td>
      <td>NaN</td>
      <td>61.0</td>
      <td>87.0</td>
      <td>17.9</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>9.0</td>
      <td>0.5</td>
      <td>81.0</td>
      <td>2.34</td>
      <td>74.0</td>
      <td>83.5</td>
      <td>0.6</td>
      <td>29606.0</td>
      <td>118637.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>51466.0</td>
      <td>95.0</td>
      <td>1.9</td>
      <td>71.0</td>
      <td>2.0</td>
      <td>504.0</td>
      <td>15.87</td>
      <td>86.0</td>
      <td>95.0</td>
      <td>19.5</td>
    </tr>
    <tr>
      <th>Estonia</th>
      <td>8.0</td>
      <td>7.0</td>
      <td>89.0</td>
      <td>2.42</td>
      <td>74.0</td>
      <td>69.0</td>
      <td>3.1</td>
      <td>19697.0</td>
      <td>159373.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>24336.0</td>
      <td>92.0</td>
      <td>1.6</td>
      <td>53.0</td>
      <td>2.7</td>
      <td>524.0</td>
      <td>14.90</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>17.7</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>6.0</td>
      <td>0.5</td>
      <td>88.0</td>
      <td>3.81</td>
      <td>70.0</td>
      <td>85.1</td>
      <td>1.3</td>
      <td>29943.0</td>
      <td>200827.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>42964.0</td>
      <td>95.0</td>
      <td>1.9</td>
      <td>70.0</td>
      <td>2.2</td>
      <td>523.0</td>
      <td>15.17</td>
      <td>67.0</td>
      <td>95.0</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>France</th>
      <td>13.0</td>
      <td>0.5</td>
      <td>78.0</td>
      <td>7.67</td>
      <td>65.0</td>
      <td>70.5</td>
      <td>0.5</td>
      <td>31304.0</td>
      <td>280653.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>43755.0</td>
      <td>90.0</td>
      <td>1.8</td>
      <td>66.0</td>
      <td>2.1</td>
      <td>496.0</td>
      <td>16.36</td>
      <td>75.0</td>
      <td>81.0</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>14.0</td>
      <td>0.2</td>
      <td>87.0</td>
      <td>4.26</td>
      <td>75.0</td>
      <td>72.5</td>
      <td>0.5</td>
      <td>34294.0</td>
      <td>259667.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>47585.0</td>
      <td>90.0</td>
      <td>1.8</td>
      <td>65.0</td>
      <td>1.8</td>
      <td>508.0</td>
      <td>15.62</td>
      <td>76.0</td>
      <td>91.0</td>
      <td>18.1</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>18.0</td>
      <td>0.5</td>
      <td>73.0</td>
      <td>6.42</td>
      <td>53.0</td>
      <td>60.0</td>
      <td>0.8</td>
      <td>17700.0</td>
      <td>150134.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>26064.0</td>
      <td>80.0</td>
      <td>1.2</td>
      <td>74.0</td>
      <td>1.8</td>
      <td>458.0</td>
      <td>NaN</td>
      <td>64.0</td>
      <td>69.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>19.0</td>
      <td>4.7</td>
      <td>84.0</td>
      <td>3.03</td>
      <td>68.0</td>
      <td>56.3</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>104458.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>22576.0</td>
      <td>86.0</td>
      <td>1.2</td>
      <td>60.0</td>
      <td>1.2</td>
      <td>474.0</td>
      <td>NaN</td>
      <td>70.0</td>
      <td>77.0</td>
      <td>16.4</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>15.06</td>
      <td>86.0</td>
      <td>86.0</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>...</td>
      <td>61787.0</td>
      <td>98.0</td>
      <td>1.6</td>
      <td>76.0</td>
      <td>2.1</td>
      <td>481.0</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>99.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>7.0</td>
      <td>1.0</td>
      <td>82.0</td>
      <td>5.25</td>
      <td>67.0</td>
      <td>75.9</td>
      <td>0.7</td>
      <td>25310.0</td>
      <td>217130.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>47653.0</td>
      <td>95.0</td>
      <td>2.1</td>
      <td>83.0</td>
      <td>1.3</td>
      <td>509.0</td>
      <td>NaN</td>
      <td>65.0</td>
      <td>85.0</td>
      <td>18.1</td>
    </tr>
    <tr>
      <th>Israel</th>
      <td>21.0</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>15.45</td>
      <td>69.0</td>
      <td>69.8</td>
      <td>1.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>35067.0</td>
      <td>88.0</td>
      <td>1.2</td>
      <td>84.0</td>
      <td>2.5</td>
      <td>472.0</td>
      <td>NaN</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>15.6</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>18.0</td>
      <td>0.7</td>
      <td>61.0</td>
      <td>4.11</td>
      <td>58.0</td>
      <td>58.4</td>
      <td>0.6</td>
      <td>26588.0</td>
      <td>279889.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>36658.0</td>
      <td>92.0</td>
      <td>1.4</td>
      <td>71.0</td>
      <td>2.5</td>
      <td>485.0</td>
      <td>16.47</td>
      <td>73.0</td>
      <td>71.0</td>
      <td>16.6</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>14.0</td>
      <td>6.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>75.0</td>
      <td>72.5</td>
      <td>0.2</td>
      <td>29798.0</td>
      <td>305878.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>40863.0</td>
      <td>89.0</td>
      <td>1.9</td>
      <td>36.0</td>
      <td>1.4</td>
      <td>529.0</td>
      <td>NaN</td>
      <td>53.0</td>
      <td>87.0</td>
      <td>16.4</td>
    </tr>
    <tr>
      <th>Korea</th>
      <td>28.0</td>
      <td>2.5</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>67.0</td>
      <td>66.6</td>
      <td>1.0</td>
      <td>21882.0</td>
      <td>285980.0</td>
      <td>15.0</td>
      <td>...</td>
      <td>35191.0</td>
      <td>78.0</td>
      <td>1.5</td>
      <td>33.0</td>
      <td>2.9</td>
      <td>519.0</td>
      <td>14.70</td>
      <td>77.0</td>
      <td>76.0</td>
      <td>17.3</td>
    </tr>
    <tr>
      <th>Latvia</th>
      <td>11.0</td>
      <td>13.9</td>
      <td>88.0</td>
      <td>1.27</td>
      <td>70.0</td>
      <td>62.4</td>
      <td>4.8</td>
      <td>16275.0</td>
      <td>70160.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>23683.0</td>
      <td>86.0</td>
      <td>1.2</td>
      <td>47.0</td>
      <td>2.2</td>
      <td>487.0</td>
      <td>13.83</td>
      <td>59.0</td>
      <td>79.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>Lithuania</th>
      <td>14.0</td>
      <td>13.6</td>
      <td>93.0</td>
      <td>0.54</td>
      <td>70.0</td>
      <td>55.9</td>
      <td>3.4</td>
      <td>21660.0</td>
      <td>NaN</td>
      <td>19.0</td>
      <td>...</td>
      <td>24287.0</td>
      <td>88.0</td>
      <td>1.5</td>
      <td>43.0</td>
      <td>2.4</td>
      <td>475.0</td>
      <td>NaN</td>
      <td>51.0</td>
      <td>81.0</td>
      <td>18.4</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>12.0</td>
      <td>0.5</td>
      <td>77.0</td>
      <td>3.82</td>
      <td>66.0</td>
      <td>75.8</td>
      <td>0.6</td>
      <td>39264.0</td>
      <td>769053.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>63062.0</td>
      <td>93.0</td>
      <td>1.9</td>
      <td>69.0</td>
      <td>1.7</td>
      <td>483.0</td>
      <td>NaN</td>
      <td>91.0</td>
      <td>84.0</td>
      <td>15.1</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>16.0</td>
      <td>25.5</td>
      <td>38.0</td>
      <td>28.70</td>
      <td>61.0</td>
      <td>41.8</td>
      <td>18.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>...</td>
      <td>15314.0</td>
      <td>81.0</td>
      <td>1.0</td>
      <td>66.0</td>
      <td>3.2</td>
      <td>416.0</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>15.2</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>14.0</td>
      <td>0.1</td>
      <td>78.0</td>
      <td>0.42</td>
      <td>76.0</td>
      <td>82.0</td>
      <td>0.6</td>
      <td>29333.0</td>
      <td>157824.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>52877.0</td>
      <td>91.0</td>
      <td>1.9</td>
      <td>76.0</td>
      <td>2.6</td>
      <td>508.0</td>
      <td>NaN</td>
      <td>82.0</td>
      <td>93.0</td>
      <td>18.7</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>5.0</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>15.11</td>
      <td>77.0</td>
      <td>65.7</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>388514.0</td>
      <td>26.0</td>
      <td>...</td>
      <td>40043.0</td>
      <td>96.0</td>
      <td>2.4</td>
      <td>88.0</td>
      <td>2.5</td>
      <td>506.0</td>
      <td>14.87</td>
      <td>80.0</td>
      <td>89.0</td>
      <td>17.7</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>5.0</td>
      <td>0.0</td>
      <td>82.0</td>
      <td>2.93</td>
      <td>74.0</td>
      <td>90.1</td>
      <td>0.4</td>
      <td>35725.0</td>
      <td>228936.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>51212.0</td>
      <td>94.0</td>
      <td>2.1</td>
      <td>77.0</td>
      <td>2.2</td>
      <td>504.0</td>
      <td>15.56</td>
      <td>78.0</td>
      <td>98.0</td>
      <td>18.3</td>
    </tr>
    <tr>
      <th>OECD - Total</th>
      <td>14.0</td>
      <td>4.4</td>
      <td>78.0</td>
      <td>11.01</td>
      <td>68.0</td>
      <td>68.4</td>
      <td>3.7</td>
      <td>33604.0</td>
      <td>408376.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>43241.0</td>
      <td>89.0</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>2.4</td>
      <td>486.0</td>
      <td>14.98</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>17.2</td>
    </tr>
    <tr>
      <th>Poland</th>
      <td>22.0</td>
      <td>3.0</td>
      <td>92.0</td>
      <td>5.95</td>
      <td>66.0</td>
      <td>67.3</td>
      <td>0.7</td>
      <td>19814.0</td>
      <td>210991.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>27046.0</td>
      <td>86.0</td>
      <td>1.1</td>
      <td>58.0</td>
      <td>2.6</td>
      <td>504.0</td>
      <td>14.42</td>
      <td>55.0</td>
      <td>82.0</td>
      <td>17.6</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>10.0</td>
      <td>1.0</td>
      <td>48.0</td>
      <td>8.27</td>
      <td>68.0</td>
      <td>73.4</td>
      <td>1.0</td>
      <td>21203.0</td>
      <td>232666.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>25367.0</td>
      <td>88.0</td>
      <td>1.7</td>
      <td>48.0</td>
      <td>1.5</td>
      <td>497.0</td>
      <td>NaN</td>
      <td>56.0</td>
      <td>86.0</td>
      <td>16.9</td>
    </tr>
    <tr>
      <th>Russia</th>
      <td>15.0</td>
      <td>14.8</td>
      <td>94.0</td>
      <td>0.14</td>
      <td>70.0</td>
      <td>52.8</td>
      <td>9.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>89.0</td>
      <td>0.9</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>492.0</td>
      <td>NaN</td>
      <td>68.0</td>
      <td>55.0</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>Slovak Republic</th>
      <td>21.0</td>
      <td>1.2</td>
      <td>91.0</td>
      <td>4.14</td>
      <td>66.0</td>
      <td>63.5</td>
      <td>0.8</td>
      <td>20474.0</td>
      <td>119696.0</td>
      <td>23.0</td>
      <td>...</td>
      <td>24328.0</td>
      <td>91.0</td>
      <td>1.1</td>
      <td>66.0</td>
      <td>3.0</td>
      <td>463.0</td>
      <td>NaN</td>
      <td>60.0</td>
      <td>85.0</td>
      <td>15.8</td>
    </tr>
    <tr>
      <th>Slovenia</th>
      <td>16.0</td>
      <td>0.4</td>
      <td>88.0</td>
      <td>4.39</td>
      <td>69.0</td>
      <td>86.1</td>
      <td>0.6</td>
      <td>20820.0</td>
      <td>203044.0</td>
      <td>18.0</td>
      <td>...</td>
      <td>34933.0</td>
      <td>92.0</td>
      <td>1.5</td>
      <td>64.0</td>
      <td>2.5</td>
      <td>509.0</td>
      <td>14.75</td>
      <td>53.0</td>
      <td>90.0</td>
      <td>18.3</td>
    </tr>
    <tr>
      <th>South Africa</th>
      <td>22.0</td>
      <td>37.0</td>
      <td>73.0</td>
      <td>18.12</td>
      <td>43.0</td>
      <td>36.1</td>
      <td>13.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.92</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>11.0</td>
      <td>0.1</td>
      <td>59.0</td>
      <td>4.01</td>
      <td>62.0</td>
      <td>82.1</td>
      <td>0.6</td>
      <td>23999.0</td>
      <td>373548.0</td>
      <td>21.0</td>
      <td>...</td>
      <td>38507.0</td>
      <td>93.0</td>
      <td>1.9</td>
      <td>72.0</td>
      <td>1.8</td>
      <td>491.0</td>
      <td>15.93</td>
      <td>70.0</td>
      <td>72.0</td>
      <td>17.9</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>6.0</td>
      <td>0.0</td>
      <td>83.0</td>
      <td>1.07</td>
      <td>77.0</td>
      <td>75.6</td>
      <td>0.9</td>
      <td>31287.0</td>
      <td>NaN</td>
      <td>19.0</td>
      <td>...</td>
      <td>42393.0</td>
      <td>91.0</td>
      <td>1.7</td>
      <td>75.0</td>
      <td>2.0</td>
      <td>496.0</td>
      <td>15.18</td>
      <td>86.0</td>
      <td>96.0</td>
      <td>19.3</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>15.0</td>
      <td>0.1</td>
      <td>88.0</td>
      <td>0.37</td>
      <td>80.0</td>
      <td>85.3</td>
      <td>0.6</td>
      <td>37466.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>...</td>
      <td>62283.0</td>
      <td>93.0</td>
      <td>1.9</td>
      <td>78.0</td>
      <td>2.3</td>
      <td>506.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>95.0</td>
      <td>17.5</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>20.0</td>
      <td>8.0</td>
      <td>39.0</td>
      <td>32.64</td>
      <td>52.0</td>
      <td>59.8</td>
      <td>1.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>86.0</td>
      <td>1.0</td>
      <td>69.0</td>
      <td>1.5</td>
      <td>425.0</td>
      <td>14.79</td>
      <td>86.0</td>
      <td>65.0</td>
      <td>18.3</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>11.0</td>
      <td>0.3</td>
      <td>81.0</td>
      <td>12.15</td>
      <td>75.0</td>
      <td>77.7</td>
      <td>0.2</td>
      <td>28715.0</td>
      <td>548392.0</td>
      <td>26.0</td>
      <td>...</td>
      <td>43732.0</td>
      <td>94.0</td>
      <td>1.9</td>
      <td>69.0</td>
      <td>3.1</td>
      <td>500.0</td>
      <td>14.92</td>
      <td>69.0</td>
      <td>84.0</td>
      <td>17.5</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>10.0</td>
      <td>0.1</td>
      <td>91.0</td>
      <td>11.09</td>
      <td>70.0</td>
      <td>73.9</td>
      <td>5.5</td>
      <td>45284.0</td>
      <td>632100.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>60558.0</td>
      <td>91.0</td>
      <td>2.4</td>
      <td>88.0</td>
      <td>3.1</td>
      <td>488.0</td>
      <td>14.44</td>
      <td>65.0</td>
      <td>83.0</td>
      <td>17.2</td>
    </tr>
  </tbody>
</table>
<p>41 rows × 24 columns</p>
</div>




```python
# oecd 회원국 대상으로 gdp와 삶의 만족도 사이의 관계 파악을 위한 위 두 개의 데이터 프레임 병합
oecd_country_stats = pd.merge(left=gdp_per_capita_2020['GDP per capita'],
                              right = oecd_bli['Life satisfaction'],
                              left_index=True,
                              right_index=True)
```


```python
# 국가를 1인당 GDP 기준 오름차순으로 정렬후 확인
oecd_country_stats.sort_values(by='GDP per capita',inplace=True)
oecd_country_stats
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>South Africa</th>
      <td>4735.747</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>Colombia</th>
      <td>5207.238</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>6450.451</td>
      <td>6.4</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>7715.373</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>8069.104</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Russia</th>
      <td>9972.495</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>Chile</th>
      <td>12612.322</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Poland</th>
      <td>15303.544</td>
      <td>6.1</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>15372.885</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>Latvia</th>
      <td>17230.136</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>18168.338</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Slovak Republic</th>
      <td>18669.295</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>Lithuania</th>
      <td>19883.066</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>21608.349</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Czech Republic</th>
      <td>22627.469</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>Estonia</th>
      <td>22985.858</td>
      <td>5.7</td>
    </tr>
    <tr>
      <th>Slovenia</th>
      <td>25038.792</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>26831.629</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Korea</th>
      <td>30644.427</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>30657.296</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>38675.319</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>39047.860</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>39228.516</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>France</th>
      <td>39257.434</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Israel</th>
      <td>41559.509</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>42080.050</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>Belgium</th>
      <td>43813.770</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>45466.116</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Finland</th>
      <td>48461.475</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>48634.336</td>
      <td>7.1</td>
    </tr>
    <tr>
      <th>Sweden</th>
      <td>50339.201</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>51289.571</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>51885.466</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>57189.031</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>58438.845</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>63051.398</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>Norway</th>
      <td>67988.591</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>79668.502</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>81867.462</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>109602.322</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 7개 국가의 데이터 제외 후 훈련할 것이므로 필요없는데이터를 모아 뺀다.
# 40-7
omitted_indices = [1, 2, 4, 6, 37, 38, 39]
kept_indices = list(set(range(40)) - set(omitted_indices))
```


```python
# 데이터셋에서 제외된 국가
missing_data = oecd_country_stats.iloc[omitted_indices]

missing_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colombia</th>
      <td>5207.238</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>6450.451</td>
      <td>6.4</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>8069.104</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Chile</th>
      <td>12612.322</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Ireland</th>
      <td>79668.502</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>81867.462</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>109602.322</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 데이터셋에서 제외 후 남은 국가
sample_data = oecd_country_stats.iloc[kept_indices] 
```


```python
# 남은 국가의 산점도
sample_data.plot(kind='scatter',x="GDP per capita",y='Life satisfaction',figsize=(5,3))
plt.axis([0,60000,0,10])

# 언급된 5개 국가명과 좌표
position_text = {
    "Hungary": (8000, 1),
    "Korea": (26000, 1.7),
    "France": (34000, 2.4),
    "Australia": (44000, 3.0),
    "United States": (60000, 3.8),
}

# 위 5개 국가는 좌표에 빨간 점으로 표기
for country, pos_text in position_text.items():
  # 국가들의 지표
  pos_data_x, pos_data_y = sample_data.loc[country]
  
  # 국가명 표기
  country = "U.S." if country == "United States" else country

  # 화살표 그리기
  plt.annotate(country, xy=(pos_data_x, pos_data_y),
               xytext=pos_text,
               arrowprops=dict(facecolor='black', width=0.5, shrink=0.1, headwidth=5))

  # 5개국 산점도 빨간 점 그리기
  plt.plot(pos_data_x,pos_data_y,"ro")


# x 축 제목 새롭게 지정
plt.xlabel("GDP per capita (USD)")

plt.show()
```


    
![png](output_26_0.png)
    



```python
# 5개국 정보 데이터에서 확인
sample_data.loc[list(position_text.keys())]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP per capita</th>
      <th>Life satisfaction</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hungary</th>
      <td>15372.885</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>Korea</th>
      <td>30644.427</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>France</th>
      <td>39257.434</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>51885.466</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>63051.398</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div>



## 모델 선택과 훈련
모델을 훈련해 우리가 원하는 결과를 얻을 수 있도록 한다.

그러기 위해선 알맞은 모델을 선택하는 과정이 필요하다.

사이킷런이 제공하는 예측기 모델을 사용하게되면 훈련은 간단하게 진행할 수있다.


```python
# 선형회귀모델 지정
from sklearn import linear_model

lin1 = linear_model.LinearRegression()
```


```python
# 입력데이터와 타깃데이터 2 차원 어레이로 지정
Xsample = np.c_[sample_data["GDP per capita"]]
ysample = np.c_[sample_data["Life satisfaction"]]
```


```python
# 모델 훈련
lin1.fit(Xsample, ysample)
```




    LinearRegression()




```python
# intercept_[0]: 직선의 절편
# coef_[0]: 직선의 기울기

t0, t1 = lin1.intercept_[0], lin1.coef_[0][0]

print(f"절편:\t {t0}")
print(f"기울기:\t {t1}")
```

    절편:	 5.071121853750363
    기울기:	 4.1410177424136694e-05
    


```python
# 산점도
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3))
plt.xlabel("GDP per capita (USD)")
plt.axis([0, 60000, 0, 10])

# 직선 그리기
X=np.linspace(0, 60000, 1000)
plt.plot(X, t0 + t1*X, "b")

# 직선의 절편과 기울기 정보 명시
plt.text(5000, 3.1, r"$\theta_0 = 5.07$", fontsize=14, color="b")
plt.text(5000, 2.2, r"$\theta_1 = 4.14 \times 10^{-5}$", fontsize=14, color="b")

plt.show()
```


    
![png](output_33_0.png)
    


## 모델 적용
키프러스 1인당GDP이용해 삶의 만족도 예측


```python
cyprus_gdp_per_capita_2020 = gdp_per_capita_2020.loc["Cyprus"]["GDP per capita"]

cyprus_gdp_per_capita_2020
```




    26240.048




```python
cyprus_predicted_life_satisfaction = lin1.predict([[cyprus_gdp_per_capita_2020]])[0, 0]

cyprus_predicted_life_satisfaction
```




    6.157726897048226




```python
# 산점도
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(5,3))
plt.xlabel("GDP per capita (USD)")
plt.axis([0, 60000, 0, 10])

# 직선 그리기
X=np.linspace(0, 60000, 1000)
plt.plot(X, t0 + t1*X, "b")

# 예측한 키프러스의 삶의 만족도를 확인해보았다.
plt.plot(cyprus_gdp_per_capita_2020,cyprus_predicted_life_satisfaction,"ro")


plt.show()
```


    
![png](output_37_0.png)
    


(제외했던 국가들을 포함해 그래프 그리고 비교하기)


```python
# 제외했던 국가 이름과 좌표
position_text2 = {
    "Colombia": (1000, 9.0),
    "Brazil": (11000, 8.5),
    "Mexico": (25000, 9.0),
    "Chile": (35000, 9.0),
    "Ireland": (60000, 3),
    "Switzerland": (72000, 3.0),
    "Luxembourg": (90000, 3.0),
}
```


```python
# 7개 국가를 제외한 국가들의 산점도 (파랑색 점)
sample_data.plot(kind='scatter', x="GDP per capita", y='Life satisfaction', figsize=(8,3))
plt.axis([0, 110000, 0, 10])

# 제외된 국가 빨간 네모로 표시 + 화살표로 국가명 표시
for country, pos_text in position_text2.items():
    pos_data_x, pos_data_y = missing_data.loc[country]
    # 7개 국가명 표기
    plt.annotate(country, xy=(pos_data_x, pos_data_y), xytext=pos_text, fontsize=8.7,
            arrowprops=dict(facecolor='black', width=0.5, shrink=0.1, headwidth=5))
    plt.plot(pos_data_x, pos_data_y, "rs")

# 7개 국가 제외 예측 선형 모델 그래프 (파랑 점선)
X=np.linspace(0, 110000, 1000)
plt.plot(X, t0 + t1*X, "b:")

# 7개 국가 포함 선형회귀 모델 훈련, 예측
lin_reg_full = linear_model.LinearRegression()
Xfull = np.c_[oecd_country_stats["GDP per capita"]]
yfull = np.c_[oecd_country_stats["Life satisfaction"]]
lin_reg_full.fit(Xfull, yfull)

# 7개 국가 포함 예측 선형 모델 그래프(검정 실선)
t0full, t1full = lin_reg_full.intercept_[0], lin_reg_full.coef_[0][0]
X = np.linspace(0, 110000, 1000)
plt.plot(X, t0full + t1full * X, "k")
plt.xlabel("GDP per capita (USD)")

plt.show()
```


    
![png](output_40_0.png)
    


위 그래프로 알 수 있는 점은 다음과 같다.

7개 국가를 포함하는 경우와 그렇지 않은 경우 상당히 다른 선형회귀 모델이 훈련된다.

즉, 모델 훈련이 훈련 데이터 셋에 민감하게 반응한다.



=> 과대 적합 현상 발생 = 선형회귀모델이 이 1인당 GDP와 삶의 만족도의 관계를 표현하기에 부적절하다.



