---
title: '[Blog]ë¶„ë¥˜ì— ëŒ€í•œ ì •ë¦¬'
layout: post
categories:
  - Python
tag:
  - Blog
  - machinelearning
  - assignment
toc: true
toc_label: "on this page"
toc_sticky: true
published : true
---

[Getting started with classification ](https://github.com/codingalzi/ML-For-Beginners/tree/main/4-Classification/1-Introduction) ë‚´ìš©ì— ëŒ€í•œ í•™ìŠµê³¼ ì •ë¦¬ì— ëŒ€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

# ë¶„ë¥˜ ì†Œê°œ

ì•ìœ¼ë¡œ ì†Œê°œí•  4ê°œì˜ ê°•ì˜ì—ì„œëŠ” ë¨¸ì‹ ëŸ¬ë‹ì˜ ê¸°ë³¸ ì´ˆì , **ë¶„ë¥˜**ë¥¼ íƒêµ¬í•  ê²ƒì´ë‹¤.

ìš°ë¦¬ëŠ” ì•„ì‹œì•„ì™€ ì¸ë„ì˜ ëª¨ë“  í›ˆë¥­í•œ ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•´ ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ ì•ˆë‚´í•  ê²ƒì´ë‹¤.

_Hope you're hungry!_


**ë¶„ë¥˜ë€?**

íšŒê·€ ê¸°ìˆ ê³¼ ë§ì€ ê³µí†µì ì´ ìˆëŠ” ì§€ë„í•™ìŠµì˜ í•œ í˜•íƒœì´ë‹¤(ì§€ë„í•™ìŠµì€ í¬ê²Œ íšŒê·€ì™€ ë¶„ë¥˜ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŒ).

ë¨¸ì‹ ëŸ¬ë‹ì´ ë°ì´í„°ì…‹ì„ ì´ìš©í•´ ì‚¬ë¬¼ì— ëŒ€í•œ ê°’ì´ë‚˜ ì´ë¦„ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë¼ë©´ ë¶„ë¥˜ëŠ” ì´ì§„ ë¶„ë¥˜ì™€ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

[ë¶„ë¥˜ ì†Œê°œ _MIT's John Guttag](https://www.youtube.com/watch?v=eg8DJYwdMyg)

**ê¸°ì–µí•´ì•¼í•  ê²ƒ**
- ì„ í˜•íšŒê·€ëŠ” ë³€ìˆ˜ê°„ ê´€ê³„ë¥¼ ì˜ˆì¸¡í•˜ê³  ìƒˆ ë°ì´í„°ê°€ í•´ë‹¹ ì„ ê³¼ ê´€ë ¨ëœ ìœ„ì¹˜ì— ëŒ€í•´ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ ë•ëŠ”ë‹¤. (ì˜ˆë¥¼ ë“¤ë©´ 9ì›ê³¼ 12ì›”ì˜ í˜¸ë°•ê°€ê²©ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒ)
- ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” `ì´ì§„ë²”ì£¼`ë¥¼ ë°œê²¬í•˜ëŠ”ë° ë„ì›€ì´ ëœë‹¤. (ì–´ë–¤ ê°€ê²©ëŒ€ì—ì„œ ì´ í˜¸ë°•ì´ ì£¼í™©ìƒ‰ì¸ì§€ ì•„ë‹Œì§€ì™€ ê°™ì€ ê²ƒ ì˜ˆì¸¡)

__ë¶„ë¥˜__ ëŠ” ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ ë°ì´í„° í¬ì¸íŠ¸ì˜ ë ˆì´ë¸” ë˜ëŠ” í´ë˜ìŠ¤ë¥¼ ê²°ì •í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ì„ ê²°ì •í•œë‹¤.

ì´ ìš”ë¦¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ ì¬ë£Œ ê·¸ë£¹ì„ ê´€ì°°í•´ ì›ì‚°ì§€ ìš”ë¦¬ë¥¼ ê²°ì •í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.

## ì†Œê°œ

ë¶„ë¥˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ì—°êµ¬ì›ê³¼ ë°ì´í„° ê³¼í•™ìì˜ ê¸°ë³¸ í™œë™ ì¤‘ í•˜ë‚˜ì´ë‹¤.

ì´ì§„ ê°’ì˜ ê¸°ë³¸ ë¶„ë¥˜(ìŠ¤íŒ¸ ë©”ì¼ì¸ì§€ ì•„ë‹Œì§€)ì—ì„œ ì»´í“¨í„°ì˜ ë¹„ì „ì„ ì‚¬ìš©í•œ ë³µì¡í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ì„¸ë¶„í™”ì— ì´ë¥´ê¸°ê¹Œì§€ ë°ì´í„°ë¥¼ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•˜ê³  ì§ˆë¬¸í•  ìˆ˜ ìˆëŠ” ê²ƒì€ í•­ìƒ ìœ ìš©í•˜ë‹¤.

ë³´ë‹¤ ê³¼í•™ì ì¸ ë°©ì‹ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ë¶„ë¥˜ë°©ë²•ì€ ì…ë ¥ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì¶œë ¥ ë³€ìˆ˜ì— ë§¤í•‘í•  ìˆ˜ ìˆëŠ” ì˜ˆì¸¡ ëª¨ë¸ì„ ìƒì„±í•œë‹¤.

ë°ì´í„° ì •ë¦¬, ì‹œê°í™”, MLì‘ì—… ì¤€ë¹„ ê³¼ì •ì„ ì‹œì‘í•˜ê¸° ì „ì— ë¨¸ì‹ ëŸ¬ë‹ì„ í™œìš©í•œ ë°ì´í„°ë¶„ë¥˜ì˜ ë‹¤ì–‘í•œ ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.

í†µê³„ì—ì„œ íŒŒìƒëœ ê³ ì „ì ì¸ ë¨¸ì‹ ëŸ¬ë‹ì„ ì‚¬ìš©í•œ ë¶„ë¥˜ëŠ” `í¡ì—°ì`, `ì²´ì¤‘`, `ì—°ë ¹`ê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ Xì§ˆë³‘ì´ ë°œë³‘ë  ê°€ëŠ¥ì„±ì„ ê²°ì •í•œë‹¤.

íšŒê·€ì—°ê¸‰ê³¼ ìœ ì‚¬í•œ ì§€ë„í•™ìŠµ ê¸°ìˆ ë¡œ ë°ì´í„°ì— ë ˆì´ë¸”ì´ ì§€ì •ë˜ê³ , MLì•Œê³ ë¦¬ì¦˜ì€ í•´ë‹¹ ë ˆì´ë¸”ì„ ì‚¬ìš©í•´ ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤(íŠ¹ì„±)ë¥¼ ë¶„ë¥˜/ì˜ˆì¸¡í•˜ê³  ê·¸ë£¹ì´ë‚˜ ê²°ê³¼ì— í• ë‹¹í•˜ê²Œ ëœë‹¤.

âœ… ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„°ì…‹ì„ ìƒìƒí•´ë´ë¼. 

- ë‹¤ì¤‘ í´ë˜ìŠ¤ ëª¨ë¸ì€ ë¬´ì—‡ì— ë‹µí•  ìˆ˜ ìˆì„ê¹Œ?
- ì´ì§„ ëª¨ë¸ì€ ë¬´ì—‡ì— ë‹µí•  ìˆ˜ ìˆì„ê¹Œ?
- ìš”ë¦¬ì— í˜¸ë¡œíŒŒ(fenugreek)ì„ ì‚¬ìš©í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?
- ìŠ¤íƒ€ ì•„ë‹ˆìŠ¤(star anise), ì•„í‹°ì´ˆí¬(artichokes), ì½œë¦¬í”Œë¼ì›Œ(cauliflower),ì™€ì‚¬ë¹„(horseradish)ë¡œ ê°€ë“ ì°¬ ì‹ë£Œí’ ê°€ë°©ì„ ì„ ë¬¼ë¡œ ì£¼ì–´ ì „í˜•ì ì¸ ì¸ë„ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°€ë¥¼ ì•Œê³ ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?



## ë¶„ë¥˜

ì´ ìš”ë¦¬ ë°ì´í„°ì…‹ì— ëŒ€í•´ ë¬»ê³ ì‹¶ì€ ì§ˆë¬¸ì€ ì‹¤ì œë¡œ ì—¬ëŸ¬ ì ì¬ì ì¸ êµ­ê°€ì˜ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë‹¤ì¤‘ í´ë˜ìŠ¤ ì§ˆë¬¸ì— í•´ë‹¹í•  ê²ƒì´ë‹¤.

ì¬ë£Œ ë°°ì¹˜ê°€ ì£¼ì–´ì§€ë©´ ë§ì€ í´ë˜ìŠ¤ ì¤‘ ë°ì´í„°ê°€ ë§ëŠ” ê²ƒì€ ë¬´ì—‡ì¼ê¹Œ?

---

Scikit-learnì€ í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œì˜ ì¢…ë¥˜ì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ”ë° ì‚¬ìš©í•  ì—¬ëŸ¬ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•œë‹¤.

ë‹¤ìŒì— ì†Œê°œí•  ë‘ ê°•ì˜ì—ì„œëŠ” ì´ëŸ¬í•œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ëª‡ ê°€ì§€ì— ëŒ€í•´ ë°°ìš¸ ê²ƒì´ë‹¤.

## ì—°ìŠµë¬¸ì œ - ë°ì´í„° ì •ë¦¬ì™€ ê· í˜• ë§ì¶”ê¸°

í•­ìƒ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „ ê°€ì¥ ë¨¼ì € í•´ì•¼í•  ì¼ì€ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ê· í˜•ì„ ë§ì¶”ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” ìš°ë¦¬ê°€ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

****

imblearnì€ ë°ì´í„°ì˜ ê· í˜•ì„ ë” ì˜ ë§ì¶œ ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” Scikit-learn íŒ¨í‚¤ì§€ì´ë‹¤.


```python
# imblearnì„ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.
pip install imblearn
```

    Collecting imblearn
      Downloading imblearn-0.0-py2.py3-none-any.whl (1.9 kB)
    Collecting imbalanced-learn
      Downloading imbalanced_learn-0.9.0-py3-none-any.whl (199 kB)
    Requirement already satisfied: scipy>=1.1.0 in c:\users\pc\anaconda3\lib\site-packages (from imbalanced-learn->imblearn) (1.7.1)
    Requirement already satisfied: threadpoolctl>=2.0.0 in c:\users\pc\anaconda3\lib\site-packages (from imbalanced-learn->imblearn) (2.2.0)
    Collecting scikit-learn>=1.0.1
      Downloading scikit_learn-1.0.2-cp39-cp39-win_amd64.whl (7.2 MB)
    Requirement already satisfied: joblib>=0.11 in c:\users\pc\anaconda3\lib\site-packages (from imbalanced-learn->imblearn) (1.1.0)
    Requirement already satisfied: numpy>=1.14.6 in c:\users\pc\anaconda3\lib\site-packages (from imbalanced-learn->imblearn) (1.20.3)
    Installing collected packages: scikit-learn, imbalanced-learn, imblearn
      Attempting uninstall: scikit-learn
        Found existing installation: scikit-learn 0.24.2
        Uninstalling scikit-learn-0.24.2:
          Successfully uninstalled scikit-learn-0.24.2
    Successfully installed imbalanced-learn-0.9.0 imblearn-0.0 scikit-learn-1.0.2
    Note: you may need to restart the kernel to use updated packages.
    


```python
# ë°ì´í„°ë¥¼ í‘œì‹œí•˜ê³  ì‹œê°í™”í•˜ëŠ”ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ importí•œë‹¤.
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib as mpl
import numpy as np

# imblearnì—ì„œ SMOTEë„ ë¶ˆëŸ¬ì˜¨ë‹¤
from imblearn.over_sampling import SMOTE
```


```python
# ì´ì œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.
# read_csv()ë¥¼ ì‚¬ìš©í•´ csvíŒŒì¼ì˜ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ê³  ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤.
df  = pd.read_csv('cuisines.csv')
```


```python
# ë°ì´í„°ì˜ í˜•íƒœë¥¼ ì‚´í´ë³´ê¸° ìœ„í•´ ë§¨ ì• ë°ì´í„° 5ê°œë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>cuisine</th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>66</td>
      <td>indian</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>68</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>69</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 385 columns</p>
</div>




```python
# info()ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ê°€ ìš”ì•½ë˜ì–´ ë‚˜ì˜¨ë‹¤.
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    

### ìš”ë¦¬ì— ëŒ€í•´ ë°°ìš°ì!(ë°ì´í„°ì— ëŒ€í•œ ì •ë³´)

ì´ì œ ì‘ì—…ì´ ë” í¥ë¯¸ë¡œì›Œì§ˆ ê²ƒì´ë‹¤.
ìš”ë¦¬ë³„ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ì•Œì•„ë³´ì.


```python
df.cuisine.value_counts().plot.barh()
```




    <AxesSubplot:>




    
![ì‚¬ì§„](/assets/img/output_21_1.png)
    


ìš”ë¦¬ì˜ ìˆ˜ëŠ” ìœ í•œí•œì§€ë§Œ ë°ì´í„°ì˜ ë¶„í¬ëŠ” ê³ ë¥´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ë¥¼ ê³ ì³ë³´ì. í•˜ì§€ë§Œ ê·¸ ì „ì— ì¡°ê¸ˆ ë” íƒìƒ‰í•  ê²ƒ.


```python
# ìš”ë¦¬ ë³„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì˜ ì–‘ì„ í™•ì¸ í›„ ì¶œë ¥í•˜ì
thai_df = df[(df.cuisine == "thai")]
japanese_df = df[(df.cuisine == "japanese")]
chinese_df = df[(df.cuisine == "chinese")]
indian_df = df[(df.cuisine == "indian")]
korean_df = df[(df.cuisine == "korean")]

print(f'thai df: {thai_df.shape}')
print(f'japanese df: {japanese_df.shape}')
print(f'chinese df: {chinese_df.shape}')
print(f'indian df: {indian_df.shape}')
print(f'korean df: {korean_df.shape}')
```

    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    

### ì¬ë£Œ ì°¾ê¸°

ë°ì´í„°ë¥¼ ë” ìì„¸íˆ ì‚´í´ë³´ê³  ìš”ë¦¬ë³„ë¡œ ì¼ë°˜ì ì¸ ì¬ë£Œê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ì.

ë°˜ë³µë˜ëŠ” ë°ì´í„°ëŠ” ìš”ë¦¬ ê°„ì— í˜¼ë™ì„ ì¤„ ê²ƒì´ë‹¤. ìš°ë¦¬ëŠ” ì´ë¥¼ ì •ë¦¬í•´ì•¼í•œë‹¤.

`create_ingredient()`í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¬ë£Œ ë°ì´í„° í”„ë ˆì„ì„ ë§Œë“¤ ê²ƒì´ë‹¤. ì´ ê¸°ëŠ¥ì€ ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ” ì—´ì„ ì‚­ì œí•˜ê³  ê°œìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¬ë£Œë¥¼ ì •ë ¬í•œë‹¤.


```python
# ìš°ë¦¬ëŠ” ì•„ë˜ì˜ í•¨ìˆ˜ë¡œ ìš”ë¦¬ë³„ë¡œ ê°€ì¥ ì¸ê¸°ìˆëŠ” ìƒìœ„ 10ê°œì˜ ì¬ë£Œë¥¼ ì•Œ ìˆ˜ ìˆë‹¤
def create_ingredient_df(df):
    ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
    ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
    ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
    inplace=False)
    return ingredient_df
```

íƒœêµ­ ìŒì‹ì— ëŒ€í•´ `barh()`ë¡œ ë‚˜íƒ€ë‚´ê¸°


```python
thai_ingredient_df = create_ingredient_df(thai_df)
thai_ingredient_df.head(10).plot.barh()
```




    <AxesSubplot:>




    
![pic2](/assets/img/output_28_1.png)
    


ì¼ë³¸ ìŒì‹ì— ëŒ€í•´ `barh()` ë¡œ ë‚˜íƒ€ë‚´ê¸°


```python
japanese_ingredient_df = create_ingredient_df(japanese_df)
japanese_ingredient_df.head(10).plot.barh()
```




    <AxesSubplot:>




    
![png3](/assets/img/output_30_1.png)
    


í•œêµ­ ìŒì‹ì— ëŒ€í•´ `barh()` ë¡œ ë‚˜íƒ€ë‚´ê¸°


```python
korean_ingredient_df = create_ingredient_df(korean_df)
korean_ingredient_df.head(10).plot.barh()
```




    <AxesSubplot:>




    
![png4](/assets/img/output_32_1.png)
    


ì´ì œ `drop()`ì„ ì‚¬ìš©í•´ ê³ ìœ í•œ ìš”ë¦¬ ê°„ í˜¼ë™ì„ ì¼ìœ¼í‚¤ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ì¬ë£Œë¥¼ ì‚­ì œí•  ê²ƒì´ë‹¤.

ìœ„ ìë£Œ ì´ì™¸ì— ë‹¤ë¥¸ ì—¬ëŸ¬ ë‚˜ë¼ì˜ ìŒì‹ì„ í™•ì¸í•´ë³´ë©´ ë³´í†µ ìŒ€, ë§ˆëŠ˜, ìƒê°•ì€ ëŒ€ë¶€ë¶„ ì¬ë£Œë¡œ ë“¤ì–´ê°€ìˆë‹¤.


```python
# ìŒ€, ë§ˆëŠ˜, ìƒê°• drop
feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
labels_df = df.cuisine #.unique()
feature_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>artemisia</th>
      <th>artichoke</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 380 columns</p>
</div>



### ë°ì´í„°ì…‹ ê· í˜• ë§ì¶”ê¸°

SMOTE("Synthetic Minority Over-sampling Technique")ë¥¼ ì‚¬ìš©í•´ ê· í˜•ì„ ë§ì¶”ì.

`fit_resample()`ì„ í˜¸ì¶œí•œë‹¤. ì´ëŠ” ë³´ê°„ë²•ìœ¼ë¡œ ìƒˆ ìƒ˜í”Œì„ ìƒì„±í•œë‹¤.


```python
oversample = SMOTE()
transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
```

ë°ì´í„° ê· í˜•ì„ ë§ì¶¤ìœ¼ë¡œ ìš°ë¦° ë¶„ë¥˜ì—ì„œ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì„ ê²ƒì´ë‹¤.

ì´ì§„ ë¶„ë¥˜ë¥¼ ìƒê°í•´ë³´ì.
ë§Œì•½ ìš°ë¦¬ì˜ ë°ì´í„°ê°€ í•œ í´ë˜ìŠ¤ë¼ë©´ í•´ë‹¹ í´ë˜ìŠ¤ì— ëŒ€í•œ ë°ì´í„°ê°€ ë” ë§ê¸° ë•Œë¬¸ì— ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ë” ìì£¼ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡í•  ê²ƒì´ë‹¤.

ë°ì´í„° ê· í˜•ì„ ë§ì¶”ë©´ ì™œê³¡ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì´ëŸ° ë¶ˆê· í˜•ì„ ì œê±°í•˜ëŠ” ë°ì— ë„ì›€ì´ ëœë‹¤.


```python
# ì¬ë£Œë‹¹ ë¼ë²¨ì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•œë‹¤.
print(f'new label count: {transformed_label_df.value_counts()}')
print(f'old label count: {df.cuisine.value_counts()}')
```

    new label count: indian      799
    thai        799
    chinese     799
    japanese    799
    korean      799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    

ìœ„ ë°ì´í„°ë¥¼ ë³´ë©´ ì˜ ì •ë¦¬ë˜ì–´ìˆë‹¤.

ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ë ˆì´ë¸” ë° ê¸°ëŠ¥ì„ í¬í•¨í•´ ê· í˜•ì¡íŒ ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ì— ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤.


```python
transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
```

`transformed_df.head()`ì™€ `transformed_df.info()`ë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ í•œë²ˆì— ë³¼ ìˆ˜ ìˆë‹¤.


```python
transformed_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cuisine</th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>artemisia</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>indian</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 381 columns</p>
</div>




```python
transformed_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 3995 entries, 0 to 3994
    Columns: 381 entries, cuisine to zucchini
    dtypes: int64(380), object(1)
    memory usage: 11.6+ MB
    


```python
transformed_df.to_csv("cleaned_cuisines.csv")
```

## ê³ ë¯¼í•´ë³¼ ê²ƒ

ì´ì§„/ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ì— ì í•©í•œ ë°ì´í„°ë¥¼ ë³´ë©° ìš°ë¦¬ëŠ” ê·¸ ë°ì´í„°ì…‹ì— ëŒ€í•´ ì–´ë–¤ ì§ˆë¬¸ì„ ë˜ì§ˆ ìˆ˜ ìˆì„ì§€ ê³ ë¯¼í•´ë³´ì.

# ìš”ë¦¬ ë¶„ë¥˜ê¸°1

ìœ„ì—ì„œ ì •ë¦¬ëœ ë°ì´í„°ë¡œ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•´ ì¬ë£Œ ê·¸ë£¹ì„ ê¸°ë°˜ìœ¼ë¡œ ì£¼ì–´ì§„ êµ­ê°€ì˜ ìš”ë¦¬ë¥¼ ì˜ˆì¸¡í•œë‹¤.

ê·¸ëŸ¬ëŠ” ë™ì•ˆ ë¶„ë¥˜ ì‘ì—…ì— ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•  ìˆ˜ ìˆëŠ” ëª‡ê°€ì§€ ë°©ë²•ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³¼ ê²ƒì´ë‹¤.

## ì—°ìŠµë¬¸ì œ - êµ­ê°€ì˜ ìš”ë¦¬ë¥¼ ì˜ˆì¸¡í•˜ì.


```python
# íŒë‹¤ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ import
import pandas as pd

# ìœ„ì—ì„œ ì €ì¥í•œ ì •ë¦¬ëœ ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°
cuisines_df = pd.read_csv("cleaned_cuisines.csv")
cuisines_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>cuisine</th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>indian</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 382 columns</p>
</div>




```python
# í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë” import
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report, precision_recall_curve
from sklearn.svm import SVC
import numpy as np
```

í›ˆë ¨ì„ ìœ„í•´ ë°ì´í„°ì…‹ì„ X,yì˜ ë‘ ê°œì˜ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë‚˜ëˆˆë‹¤.

ìš”ë¦¬ëŠ” ë ˆì´ë¸” ë°ì´í„° í”„ë ˆì„ì´ ë  ìˆ˜ ìˆë‹¤.


```python
cuisines_label_df = cuisines_df['cuisine']
cuisines_label_df.head()
```




    0    indian
    1    indian
    2    indian
    3    indian
    4    indian
    Name: cuisine, dtype: object



ì´ë¦„ ì—†ëŠ” 0ë²ˆì—´ê³¼ ìš”ë¦¬ ì—´ì„ `drop()`ì„ ì‚¬ìš©í•´ ë²„ë¦°ë‹¤.

ë‚˜ë¨¸ì§€ ë°ì´í„°ë¥¼ í•™ìŠµê°€ëŠ¥í•œ í˜•íƒœë¡œ ì €ì¥í•œë‹¤.


```python
cuisines_feature_df = cuisines_df.drop(['Unnamed: 0', 'cuisine'], axis=1)
cuisines_feature_df.head()

# ì´ë¥¼ í†µí•´ ìš°ë¦° ëª¨ë¸ í›ˆë ¨ ì¤€ë¹„ê°€ ëë‚¬ë‹¤.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>artemisia</th>
      <th>artichoke</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 380 columns</p>
</div>



### ë¶„ë¥˜ê¸° ê³ ë¥´ê¸°

ì´ì œ ë°ì´í„°ê°€ ì •ë¦¬ë˜ê³  í•™ìŠµí•  ì¤€ë¹„ê°€ ë˜ì—ˆìœ¼ë¯€ë¡œ ì‘ì—…ì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ì„ ê²°ì •í•´ì•¼í•œë‹¤.

`Scikit-learn`ì€ ì§€ë„í•™ìŠµì—ì„œ ë¶„ë¥˜ë¥¼ ê·¸ë£¹í™”í•˜ê³  í•´ë‹¹ ë²”ì£¼ì—ì„œ ë¶„ë¥˜í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.

ë‹¤ì–‘ì„±í•œ ê²ƒì€ ì²˜ìŒì—ëŠ” ê½¤ ì–´ë µê²Œ ëŠê»´ì§„ë‹¤. ì•„ë˜ëŠ” ë¶„ë¥˜ ê¸°ìˆ ì„ ë‚˜ì—´í•˜ì˜€ë‹¤.

- Linear Models
- Support Vector Machines
- Stochastic Gradient Descent
- Nearest Neighbors
- Gaussian Processes
- Decision Trees
- Ensemble methods (voting Classifier)
- Multiclass and multioutput algorithms (multiclass and multilabel classification, multiclass-multioutput classification)

#### ì–´ë–¤ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•  ê²ƒì¸ê°€?

í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ë¥¼ ì‹¤í–‰ í›„ ì¢‹ì€ ê²°ê³¼ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤.

`Scikit-learn`ì€ `KNeighbors`, `SVC`ì˜ ë‘ ê°€ì§€ ë°©ì‹ì„ ì œê³µí•œë‹¤.

ì•„ë˜ëŠ” (GaussianProcessClassifier, DecisionTreeClassifier, RandomForestClassifier, MLPClassifier, AdaBoostClassifier, GaussianNB ë° QuadraticDiscrinationAnalysis)ë¡œ ë¹„êµí•´ ìƒì„±ëœ ë°ì´í„°ì„¸íŠ¸ì— ëŒ€í•œ ë³‘ë ¬ë¹„êµë¥¼ ì œê³µí•´ ì‹œê°í™”ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.



![png5](/assets/img/mlasg7_img1.png)
    


#### ë” ì¢‹ì€ ì ‘ê·¼

ì„±ê¸‰í•˜ê²Œ ì¶”ì¸¡í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì¢‹ì€ ë°©ë²•ì€ ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•œ ë¨¸ì‹ ëŸ¬ë‹ ì¹˜íŠ¸ì‹œíŠ¸ì˜ ì•„ì´ë””ì–´ë¥¼ ë”°ë¥´ëŠ” ê²ƒì´ë‹¤.
ì—¬ê¸°ì„œ ìš°ë¦° ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¬¸ì œì— ëŒ€í•´ ëª‡ê°€ì§€ ì„ íƒì‚¬í•­ì´ ìˆìŒì„ ë°œê²¬í•œë‹¤.




![png6](/assets/img/mlasg7_img2.png)
    


#### Reasoning

ê°€ì§€ê³  ìˆëŠ” ì œì•½ì¡°ê±´ì„ ê°ì•ˆí•  ë•Œ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ì„ í†µí•´ ì¶”ë¡ ì´ ê°€ëŠ¥í•œì§€ ì‚´í´ë³´ì.

- __ì‹ ê²½ë§(Neural networks)ì€ ë„ˆë¬´ ë¬´ê²ë‹¤.__ ê¹¨ë—í•˜ì§€ë§Œ ìµœì†Œí•œì˜ ë°ì´í„°ì…‹ê³¼ ë…¸íŠ¸ë¶ì„ í†µí•´ ì´ˆì»¬ë¡œ í›ˆë ¨ì„ ì‹¤í–‰í•˜ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ê°ì•ˆí•  ë•Œ ì‹ ê²½ë§ì€ ì´ ì‘ì—…ì— ë„ˆë¬´ ë¬´ê²ë‹¤.
- __2-í´ë˜ìŠ¤ ë¶„ë¥˜ê¸°ê°€ ì—†ë‹¤.__ ìš°ë¦¬ëŠ” ì¼ëŒ€ì¼(OV)ì„ ë°°ì œí•˜ê¸° ìœ„í•´ 2-í´ë˜ìŠ¤ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. 
- __ê²°ì •íŠ¸ë¦¬ ë˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ ì‘ë™í•  ìˆ˜ ìˆë‹¤.__ ê²°ì •íŠ¸ë¦¬ê°€ ì‘ë™í•˜ê±°ë‚˜ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë°ì´í„°ì— ëŒ€í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ ì‘ë™í•  ìˆ˜ ìˆë‹¤.
- __ë‹¤ì¤‘í´ë˜ìŠ¤ ë¶€ìŠ¤íŠ¸ ê²°ì • íŠ¸ë¦¬ëŠ” ë‹¤ë¥¸ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.__ ë‹¤ì¤‘í´ë˜ìŠ¤ ë¶€ìŠ¤íŠ¸ ê²°ì •íŠ¸ë¦¬ëŠ” ë¹„ëª¨ìˆ˜ì  ì‘ì—…ì— ê°€ì¥ ì í•©í•˜ë‹¤. ìˆœìœ„ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì„¤ê³„ëœ ì‘ì—…ì´ë¯€ë¡œ ìš°ë¦¬ì—ê² ìœ ìš©í•˜ì§€ ì•Šë‹¤.

#### Scikit-learn ì‚¬ìš©í•˜ê¸°

ìš°ë¦¬ëŠ” Scikit-learnì„ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ë¶„ì„í•  ê²ƒì´ë‹¤.

í•˜ì§€ë§Œ Scikit-learnì—ì„œ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆë‹¤. ì „ë‹¬í•  íŒŒë¼ë¯¸í„°ë¥¼ ì‚´í´ë´ë¼.

ë³¸ì§ˆì ìœ¼ë¡œ ìš°ë¦¬ê°€ Scikit-learnì— ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ ìš”ì²­í•  ë•Œ ì§€ì •í•´ì•¼í•œëŠ ë‘ ê°€ì§€ ì¤‘ìš” íŒŒë¼ë¯¸í„°ì¸ `multi_class`ì™€ `solver`ê°€ ìˆë‹¤. `multi_class`ê°’ì€ íŠ¹ì • ë™ì‘ì„ì ìš©í•œë‹¤. `solver`ì˜ ê°’ì€ ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ëª¨ë“  `solver`ì™€ `multi_class`ê°€ ì§ì„ ì´ë£° ìˆ˜ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

ë¬¸ì„œì— ë”°ë¥´ë©´ ë‹¤ì¤‘ í´ë˜ìŠ¤ì˜ ê²½ìš° í•™ìŠµì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- `multi_class`ì˜µì…˜ì´ `ovr`ë¡œ ì„¤ì •ëœ ê²½ìš° one-vs-rest(OvR)ì²´ê³„ë¥¼ ì‚¬ìš©í•œë‹¤.
- `multi_class`ì˜µì…˜ì´ `multinomial`ë¡œ ì„¤ì •ëœ ê²½ìš° (í˜„ì¬ `multinomial`ì˜µì…˜ì€ â€˜lbfgsâ€™, â€˜sagâ€™, â€˜sagaâ€™,â€˜newton-cgâ€™ sloverì—ì„œë§Œ ì§€ì›ëœë‹¤.)

ğŸ“ ì—¬ê¸°ì„œ `scheme`ëŠ” `ovr`ë˜ëŠ” `multinomial`ì´ ë  ìˆ˜ ìˆë‹¤. 

ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” ì‹¤ì œë¡œ ì´ì§„ ë¶„ë¥˜ë¥¼ ì§€ì›í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ìˆìœ¼ë¯€ë¡œ ì´ëŸ¬í•œ ì²´ê³„ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‘ì—…ì„ ë” ì˜ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

ğŸ“ `solver`ëŠ” ìµœì í™” ë¬¸ì œì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì •ì˜ëœë‹¤.

`Scikit-learn`ì€ `solver`ê°€ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ë°ì´í„° êµ¬ì¡°ê°€ ì œì‹œí•˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ê¸° ìœ„í•´ ë‹¤ìŒ í‘œë¥¼ ì œê³µí•œë‹¤.


![png5](/assets/img/mlasg7_img3.png)
    


### ë°ì´í„° ë‚˜ëˆ„ê¸°


```python
# train_test_split()ì„ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ ë°ì´í„°ë¥¼ í›ˆë ¨/í…ŒìŠ¤íŠ¸ ì…‹ìœ¼ë¡œ ë¶„í• í•  ìˆ˜ ìˆë‹¤.
X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df, cuisines_label_df, test_size=0.3)
```

### ë¡œì§€ìŠ¤í‹± íšŒê·€ ì ìš©í•˜ê¸°

ë‹¤ì¤‘ í´ë˜ìŠ¤ ì‚¬ë¡€ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—, ì‚¬ìš©í•  `scheme`ì™€ `solver`ë¥¼ ì„ íƒí•´ì•¼í•œë‹¤.

í›ˆë ¨í•  ë‹¤ì¤‘ í´ë˜ìŠ¤ ì„¸íŒ…ê³¼ `liblinear solver`, `LogisticRegression`ì„ ì‚¬ìš©í•œë‹¤.


```python
# milto_classì˜ ì˜µì…˜ì„ ovrë¡œ ì„¤ì •í•˜ê³  solverì˜ ì˜µì…˜ì„ liblinearë¡œ ì„¤ì •í•´ ë¡œì§€ìŠ¤í‹± íšŒê·€ ìƒì„±
lr = LogisticRegression(multi_class='ovr',solver='liblinear')
model = lr.fit(X_train, np.ravel(y_train))

accuracy = model.score(X_test, y_test)
print ("Accuracy is {}".format(accuracy))

# ì •í™•ë„ê°€ ê±°ì˜ 80%ê°€ ë‚˜ì˜¨ë‹¤.
```

    Accuracy is 0.79232693911593
    

âœ… ì¢…ì¢… ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •ë˜ëŠ” `lbfgs`ì™€ ê°™ì€ ë‹¤ë¥¸ `solver`ë¥¼ ì‚¬ìš©í•´ë³¼ ìˆ˜ë„ ìˆë‹¤.

í•œ í–‰ì— ë°ì´í„°ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë©´ ì´ ëª¨ë¸ì´ ì‘ë™í•œëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


```python
# 50ë²ˆì§¸ í–‰
print(f'ingredients: {X_test.iloc[50][X_test.iloc[50]!=0].keys()}')
print(f'cuisine: {y_test.iloc[50]}')
```

    ingredients: Index(['coconut'], dtype='object')
    cuisine: thai
    

ë” ê¹Šì´ íŒŒê³ ë“¤ë©´ ì´ ì˜ˆì¸¡ì˜ ì •í™•ì„±ì„ í™•ì¸í•  ìˆ˜ë„ ìˆë‹¤.


```python
test= X_test.iloc[50].values.reshape(-1, 1).T
proba = model.predict_proba(test)
classes = model.classes_
resultdf = pd.DataFrame(data=proba, columns=classes)

topPrediction = resultdf.T.sort_values(by=[0], ascending = [False])
topPrediction.head()
```

    C:\Users\pc\anaconda3\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
      warnings.warn(
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>thai</th>
      <td>0.793984</td>
    </tr>
    <tr>
      <th>chinese</th>
      <td>0.071358</td>
    </tr>
    <tr>
      <th>japanese</th>
      <td>0.063747</td>
    </tr>
    <tr>
      <th>indian</th>
      <td>0.043105</td>
    </tr>
    <tr>
      <th>korean</th>
      <td>0.027805</td>
    </tr>
  </tbody>
</table>
</div>



ë¶„ë¥˜ ë³´ê³ ì„œë¥¼ ì¸ì‡„í•´ ë” ìì„¸í•œ ì •ë³´ë¥¼ ì–»ì–´ë³´ì.


```python
y_pred = model.predict(X_test)
print(classification_report(y_test,y_pred))
```

                  precision    recall  f1-score   support
    
         chinese       0.72      0.69      0.71       230
          indian       0.91      0.91      0.91       250
        japanese       0.76      0.76      0.76       245
          korean       0.84      0.75      0.79       249
            thai       0.73      0.85      0.78       225
    
        accuracy                           0.79      1199
       macro avg       0.79      0.79      0.79      1199
    weighted avg       0.79      0.79      0.79      1199
    
    

## ê³ ë¯¼í•´ë³¼ ê²ƒ

`Scikit-learn`ì´ ë°ì´í„° ë¶„ë¥˜ë¥¼ ìœ„í•´ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì‚´í´ë³´ì. ê·¸ ì•ˆì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì´í•´í•˜ì…”ë©´ `solver`ì˜ ê°œë…ì„ ë” ìì„¸íˆ ê³µë¶€í•˜ë©´ ëœë‹¤.

# ìš”ë¦¬ ë¶„ë¥˜ê¸°2

ìœ„ì—ì„œ ìš°ë¦° Microsoftì˜ ì¹˜íŠ¸ ì‹œíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì— ëŒ€í•´ ë°°ì› ë‹¤.

Scikit-learnì€ ì¶”ì •ê¸°(ë¶„ë¥˜ê¸°)ë¥¼ ì¢íˆëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ìœ ì‚¬í•˜ì§€ë§Œ ë” ì„¸ë¶„í™”ëœ ì¹˜íŠ¸ ì‹œíŠ¸ë¥¼ ì œê³µí•œë‹¤.


![png8](/assets/img/mlasg7_img4.png)
    


ìœ„ ë§µì€ ë°ì´í„°ë¥¼ ëª…í™•í•˜ê²Œ íŒŒì•…í•˜ê³  ë‚˜ë©´ ê²°ì •ì— ì´ë¥´ëŠ” ê²½ë¡œë¥¼ ë”°ë¼ê°ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.

_ì˜ˆì‹œ_
- 50ê°œì˜ ìƒ˜í”Œ
- ë²”ì£¼ë¥¼ ì˜ˆì¸¡í•˜ê³ ì‹¶ìŒ
- ë¼ë²¨ë§ëœ ë°ì´í„°ê°€ ìˆìŒ
- ì•½ 100,000ê°œì˜ ìƒ˜í”Œì´ ìˆìŒ
- ìš°ë¦° `Linear SVC`ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŒ
- ë§Œì•½ ë°ì´í„°ì˜ ìˆ˜ë¡œ ì¸í•´ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´,
    - `KNeighbors Classifier`ë¥¼ ì‹œë„í•  ìˆ˜ ì‡ìŒ
        - ë§Œì•½ ì´ë„ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, `SVC`ì™€ `Ensemble ë¶„ë¥˜ê¸°`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

#### ë°ì´í„° ë‚˜ëˆ„ê¸°


```python
# í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ import
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report, precision_recall_curve
import numpy as np
```


```python
# ë°ì´í„° ë‚˜ëˆ„ê¸°
X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df, cuisines_label_df, test_size=0.3)
```

### Linear SVC ë¶„ë¥˜ê¸°

SVC(Support-Vector clustering)ì€ ì„œí¬íŠ¸ë²¡í„°ë¨¸ì‹ ì˜ í•˜ìœ„ í•­ëª©ì´ë‹¤.

ì´ëŠ” `kernel`ì„ ì„ íƒí•´ ë ˆì´ë¸”ì„ êµ°ì§‘í™”í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•  ìˆ˜ ìˆë‹¤.

`C`íŒŒë¼ë¯¸í„°ëŠ” íŒŒë¼ë¯¸í„°ì˜ ì˜í–¥ì„ ê·œì œí•˜ëŠ” ì •ê·œí™”ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

`kernel`ì€ ì—¬ëŸ¬ê°œ ì¤‘ í•˜ë‚˜ì¼ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ Linear SVCë¥¼ í™œìš©í•˜ë„ë¡ `linear`ë¡œ ì„¤ì •í•œë‹¤. probabilityëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `false`ì´ë‹¤. í•˜ì§€ë§Œ ì—¬ê¸°ì„  í™•ë¥  ì¶”ì •ì¹˜ë¥¼ ìˆ˜ì§‘í•˜ê¸° ìœ„í•´ `true`ë¡œ ì„¤ì •í•œë‹¤. í™•ë¥ ì„ ì–»ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ì„ê³ ì ramdom_stateëŠ” `0`ìœ¼ë¡œ ì„¤ì •í•œë‹¤.


```python
C = 10
# ë‹¤ë¥¸ ë¶„ë¥˜ê¸°ë“¤ ë§Œë“¤ê¸°
classifiers = {
    'Linear SVC': SVC(kernel='linear', C=C, probability=True,random_state=0)
}
```


```python
# ë§Œë“  ëª¨ë¸ì„ í›ˆë ¨í•´ë³´ê³  ë³´ê³ ì„œë¥¼ ì¶œë ¥í•´ë³´ì.
n_classifiers = len(classifiers)

for index, (name, classifier) in enumerate(classifiers.items()):
    classifier.fit(X_train, np.ravel(y_train))

    y_pred = classifier.predict(X_test)
    accuracy = accuracy_score(y_test, y_pred)
    print("Accuracy (train) for %s: %0.1f%% " % (name, accuracy * 100))
    print(classification_report(y_test,y_pred))
```

    Accuracy (train) for Linear SVC: 76.0% 
                  precision    recall  f1-score   support
    
         chinese       0.66      0.66      0.66       248
          indian       0.89      0.87      0.88       233
        japanese       0.75      0.70      0.73       249
          korean       0.75      0.78      0.76       237
            thai       0.76      0.80      0.78       232
    
        accuracy                           0.76      1199
       macro avg       0.76      0.76      0.76      1199
    weighted avg       0.76      0.76      0.76      1199
    
    

### [K-Neighbors](https://scikit-learn.org/stable/modules/neighbors.html#neighbors) ë¶„ë¥˜ê¸°(K-ìµœê·¼ì ‘ ì´ì›ƒ, KNN)

K-Neighbors ëŠ” ì§€ë„/ë¹„ì§€ë„ í•™ìŠµ ëª¨ë‘ì— ì‚¬ìš©í•  ìˆ˜ ì´ì“´ã„´ ë¨¸ì‹ ëŸ¬ë‹ë°©ë²•ì˜ `neighbor`ê³„ì—´ì˜ ì¼ë¶€ì´ë‹¤. 

ì´ ë°©ë²•ì—ì„œ ë¯¸ë¦¬ ì •ì˜ëœ ìˆ˜ì˜ í¬ì¸íŠ¸ê°€ ìƒì„±ë˜ê³  ë°ì´í„°ì— ëŒ€í•´ ì¼ë°˜í™”ëœ ë ˆì´ë¸”ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆë„ë¡ ì£¼ë³€ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•œë‹¤.

K-Neighborsë¶„ë¥˜ê¸°ë¥¼ í†µí•´ ìš°ë¦° ë” ì¢‹ì€ ì„±ëŠ¥ì„ ì–»ì„ì§€ë„ ëª¨ë¥¸ë‹¤.


```python
# ë¶„ë¥˜ê¸° ë°°ì—´ì— ì¤„ì„ ì¶”ê°€í•œë‹¤.
# ì„±ëŠ¥ì´ ì¢‹ì§€ ì•Šë‹¤.
'KNN classifier': KNeighborsClassifier(C),
```


```python
Accuracy (train) for KNN classifier: 73.8% 
              precision    recall  f1-score   support

     chinese       0.64      0.67      0.66       242
      indian       0.86      0.78      0.82       234
    japanese       0.66      0.83      0.74       254
      korean       0.94      0.58      0.72       242
        thai       0.71      0.82      0.76       227

    accuracy                           0.74      1199
   macro avg       0.76      0.74      0.74      1199
weighted avg       0.76      0.74      0.74      1199
```

### [Support Vector](https://scikit-learn.org/stable/modules/svm.html#svm) ë¶„ë¥˜ê¸°(SVC)

ì„œí¬íŠ¸ë²¡í„°ë¨¸ì‹ ì˜ ì¼ë¶€ì´ë‹¤.

ë‘ ë²”ì£¼ ê°„ì˜ ê±°ë¦¬ë¥¼ ìµœëŒ€í™”í•˜ê¸° ìœ„í•´ __ê³µê°„ì˜ ì§€ì ì— í›ˆë ¨ ì˜ˆì œë¥¼ ë§¤í•‘__ í•œë‹¤. í›„ì† ë°ì´í„°ëŠ” í•´ë‹¹ ë²”ì£¼ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ìˆë„ë¡ ì´ ê³µí•œì— ë§¤í•‘ëœë‹¤.


```python
# ë¶„ë¥˜ê¸° ë°°ì—´ì— ì¤„ì„ ì¶”ê°€í•œë‹¤.
# ì„±ëŠ¥ì´ ê½¤ ì¢‹ì•„ì¡Œë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
'SVC': SVC(),
```


```python
Accuracy (train) for SVC: 83.2% 
              precision    recall  f1-score   support

     chinese       0.79      0.74      0.76       242
      indian       0.88      0.90      0.89       234
    japanese       0.87      0.81      0.84       254
      korean       0.91      0.82      0.86       242
        thai       0.74      0.90      0.81       227

    accuracy                           0.83      1199
   macro avg       0.84      0.83      0.83      1199
weighted avg       0.84      0.83      0.83      1199
```

### [Ensemble](https://scikit-learn.org/stable/modules/ensemble.html)ë¶„ë¥˜ê¸°

Ensemble ë¶„ë¥˜ê¸°, íŠ¹íˆ Random Forest ë° AdaBoostë¥¼ ì‚¬ìš©í•´ë³´ì.
- [Random Forest](https://scikit-learn.org/stable/modules/ensemble.html#forest) : ê²°ì •íŠ¸ë¦¬ë¥¼ ì—¬ëŸ¬ê°œ ì‚¬ìš©(`n_eatimators`íŒŒë¼ë¯¸í„°ë¡œ í›ˆë ¨ ê²°ì •íŠ¸ë¦¬ì˜ ìˆ˜ ê²°ì •
- [AdaBoost](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html) : ë¶„ë¥˜ê¸°ë¥¼ ë°ì´í„°ì…‹ì— ë§ì¶”ê³  ë¶„ë¥˜ê¸°ì˜ ë³µì‚¬ë³¸ì„ ë™ì¼ ë°ì´í„°ì…‹ì— ë§ì¶¤. ì˜ëª» ë¶„ë¥˜ëœ í•­ë³µì˜ ê°€ì¤‘ì¹˜ì— ì´ˆì ì„ ë§ì¶”ê³  ë‹¤ìŒ ë¶„ë¥˜ê¸°ê°€ ìˆ˜ì •í•˜ë„ë¡ ë§ì¶¤ì„ ì¡°ì •í•¨.


```python
  'RFST': RandomForestClassifier(n_estimators=100),
  'ADA': AdaBoostClassifier(n_estimators=100)
# ê²°ê³¼ê°€ ì¢‹ì•„ë³´ì¸ë‹¤. íŠ¹íˆ ëœë¤í¬ë ˆìŠ¤íŠ¸ì˜ ê²°ê³¼ê°€ ì¢‹ë‹¤.
```


```python
Accuracy (train) for RFST: 84.5% 
              precision    recall  f1-score   support

     chinese       0.80      0.77      0.78       242
      indian       0.89      0.92      0.90       234
    japanese       0.86      0.84      0.85       254
      korean       0.88      0.83      0.85       242
        thai       0.80      0.87      0.83       227

    accuracy                           0.84      1199
   macro avg       0.85      0.85      0.84      1199
weighted avg       0.85      0.84      0.84      1199

Accuracy (train) for ADA: 72.4% 
              precision    recall  f1-score   support

     chinese       0.64      0.49      0.56       242
      indian       0.91      0.83      0.87       234
    japanese       0.68      0.69      0.69       254
      korean       0.73      0.79      0.76       242
        thai       0.67      0.83      0.74       227

    accuracy                           0.72      1199
   macro avg       0.73      0.73      0.72      1199
weighted avg       0.73      0.72      0.72      1199
```

ë¨¸ì‹ ëŸ¬ë‹ì˜ ì´ ë°©ë²•ì€ __ì—¬ëŸ¬ ê¸°ë³¸ ì¶”ì •ê¸°ì˜ ì˜ˆì¸¡ì„ ê²°í•©í•´ ëª¨ë¸ì˜ í’ˆì§ˆì„ í–¥ìƒ__ ì‹œí‚¨ë‹¤. 

## ê³ ë¯¼í•´ë³¼ ê²ƒ

ì¡°ì • íŒŒë¼ë¯¸í„°ê°€ ë§ì€ë° ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ë¥¼ ì¡°ì‚¬í•˜ê³  ì´ëŸ° ë§¤ê°œë³€ìˆ˜ ì¡°ì •ìœ¼ë¡œ ëª¨ë¸ì˜ í’ˆì§ˆì— ì–´ë–¤ ì˜ë¯¸ê°€ ìˆëŠ”ì§€ ìƒê°í•´ë³´ì.

# ìš”ë¦¬ ì¶”ì²œ ì›¹ ì•± êµ¬ì¶•

ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•´ ë¶„ë¥˜ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³  Onnxì˜ ì›¹ì„ í™œìš©í•´ ì €ì¥ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ ê°œë°œí•  ê²ƒì´ë‹¤.

ë¨¸ì‹ ëŸ¬ë‹ì˜ ê°€ì¥ ìœ ìš©í•œ ì‹¤ì œ ìš©ë„ ì¤‘ í•˜ë‚˜ëŠ” ì¶”ì²œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì´ë‹¤.

_We can take the first step in that direction today!_

## ì—°ìŠµë¬¸ì œ - ë¶„ë¥˜ê¸° ëª¨ë¸ í›ˆë ¨

ë¨¼ì €, ì •ë¦¬ëœ ìš”ë¦¬ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•´ ë¶„ë¥˜ê¸° ëª¨ë¸ì„ í›ˆë ¨í•´ì•¼í•œë‹¤.


```python
# skl2onnxì„¤ì¹˜ í•„ìš”
!pip install skl2onnx
import pandas as pd 
```

    Collecting skl2onnx
      Downloading skl2onnx-1.11.1-py3-none-any.whl (276 kB)
    Collecting protobuf
      Downloading protobuf-3.20.1-cp39-cp39-win_amd64.whl (904 kB)
    Requirement already satisfied: scikit-learn>=0.19 in c:\users\pc\anaconda3\lib\site-packages (from skl2onnx) (1.0.2)
    Collecting onnx>=1.2.1
      Downloading onnx-1.11.0-cp39-cp39-win_amd64.whl (11.2 MB)
    Collecting onnxconverter-common>=1.7.0
      Downloading onnxconverter_common-1.9.0-py2.py3-none-any.whl (78 kB)
    Requirement already satisfied: scipy>=1.0 in c:\users\pc\anaconda3\lib\site-packages (from skl2onnx) (1.7.1)
    Requirement already satisfied: numpy>=1.15 in c:\users\pc\anaconda3\lib\site-packages (from skl2onnx) (1.20.3)
    Requirement already satisfied: typing-extensions>=3.6.2.1 in c:\users\pc\anaconda3\lib\site-packages (from onnx>=1.2.1->skl2onnx) (3.10.0.2)
    Requirement already satisfied: joblib>=0.11 in c:\users\pc\anaconda3\lib\site-packages (from scikit-learn>=0.19->skl2onnx) (1.1.0)
    Requirement already satisfied: threadpoolctl>=2.0.0 in c:\users\pc\anaconda3\lib\site-packages (from scikit-learn>=0.19->skl2onnx) (2.2.0)
    Installing collected packages: protobuf, onnx, onnxconverter-common, skl2onnx
    Successfully installed onnx-1.11.0 onnxconverter-common-1.9.0 protobuf-3.20.1 skl2onnx-1.11.1
    


```python
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê³  í™•ì¸
data = pd.read_csv('cleaned_cuisines.csv')
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>cuisine</th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>indian</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>indian</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 382 columns</p>
</div>




```python
# í•„ìš”ì—†ëŠ” ì—´ì„ ì§€ìš´ í›„ ë‚¨ì€ ë°ì´í„°ë¥¼ Xì— ì €ì¥í•œë‹¤.
X = data.iloc[:,2:]
X.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>almond</th>
      <th>angelica</th>
      <th>anise</th>
      <th>anise_seed</th>
      <th>apple</th>
      <th>apple_brandy</th>
      <th>apricot</th>
      <th>armagnac</th>
      <th>artemisia</th>
      <th>artichoke</th>
      <th>...</th>
      <th>whiskey</th>
      <th>white_bread</th>
      <th>white_wine</th>
      <th>whole_grain_wheat_flour</th>
      <th>wine</th>
      <th>wood</th>
      <th>yam</th>
      <th>yeast</th>
      <th>yogurt</th>
      <th>zucchini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 380 columns</p>
</div>




```python
# ë¼ë²¨ì€ yì— ì €ì¥í•œë‹¤.
y = data[['cuisine']]
y.head()

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cuisine</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>indian</td>
    </tr>
    <tr>
      <th>1</th>
      <td>indian</td>
    </tr>
    <tr>
      <th>2</th>
      <td>indian</td>
    </tr>
    <tr>
      <th>3</th>
      <td>indian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>indian</td>
    </tr>
  </tbody>
</table>
</div>



### í›ˆë ¨ë£¨í‹´ ì‹œì‘

SVCë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤(ì •í™•ë„ ì¢‹ìŒ).


```python
# í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬import
from sklearn.model_selection import train_test_split
from sklearn.svm import SVC
from sklearn.model_selection import cross_val_score
from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report
```


```python
# ë°ì´í„° ë‚˜ëˆ„ê¸°
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)
```


```python
# SVCë¶„ë¥˜ê¸° ëª¨ë¸ êµ¬ì¶•í•˜ê¸°
model = SVC(kernel='linear', C=10, probability=True,random_state=0)
model.fit(X_train,y_train.values.ravel())
```




    SVC(C=10, kernel='linear', probability=True, random_state=0)




```python
# ëª¨ë¸ì˜ predict()ë¥¼ ì‚¬ìš©í•´ ì˜ˆì¸¡í•´ë³´ì.
y_pred = model.predict(X_test)
```


```python
# ëª¨ë¸ì˜ ì„±ëŠ¥ ì¶œë ¥
print(classification_report(y_test,y_pred))
```

                  precision    recall  f1-score   support
    
         chinese       0.69      0.76      0.72       264
          indian       0.86      0.89      0.88       227
        japanese       0.71      0.67      0.68       230
          korean       0.84      0.75      0.79       244
            thai       0.76      0.78      0.77       234
    
        accuracy                           0.77      1199
       macro avg       0.77      0.77      0.77      1199
    weighted avg       0.77      0.77      0.77      1199
    
    

## ëª¨ë¸ì„ Onnxë¡œ ë³€í™˜

ì ì ˆí•œ Tensor ë²ˆí˜¸ë¡œì˜ ë³€í™˜ì„ ìˆ˜í–‰í•´ì•¼í•œë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” 380ê°œì˜ íŠ¹ì„±ì´ ë‚˜ì—´ë˜ì–´ ìˆìœ¼ë¯€ë¡œ FloatTensorTypeì— í•´ë‹¹ ìˆ«ìë¥¼ í‘œê¸°í•´ì•¼ í•œë‹¤.


```python
# 380ì˜ Tenserë²ˆí˜¸ ì‚¬ìš©í•´ ë³€í™˜
from skl2onnx import convert_sklearn
from skl2onnx.common.data_types import FloatTensorType

initial_type = [('float_input', FloatTensorType([None, 380]))]
options = {id(model): {'nocl': True, 'zipmap': False}}
```


```python
# onxë§Œë“¤ê³  model.onnxì˜ íŒŒì¼ ì €ì¥í•˜ê¸°
onx = convert_sklearn(model, initial_types=initial_type, options=options)
with open("./model.onnx", "wb") as f:
    f.write(onx.SerializeToString())
```

> __ì£¼ì˜í•  ì __
>
> ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì˜µì…˜ì„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° `nocl`ì„ `true`ë¡œã…¡ `zipmap`ì„ `false`ë¡œ í•œë‹¤.
>
> ì´ê²ƒì€ ë¶„ë¥˜ëª¨ë¸ì´ë¯€ë¡œ ì‚¬ì „ ëª©ë¡ì„ ìƒì„±í•˜ëŠ” ZipMapì„ ì œê²…í•˜ëŠ” ì˜µì…˜ì´ ìˆë‹¤. ì´ëŠ” í•„ìˆ˜ëŠ” ì•„ë‹ˆë‹¤.
>
>`nocl`ì„ `true`ë¡œ ì„¤ì •í•´ ëª¨ë¸ì˜ í¬ê¸°ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

### ëª¨ë¸ ì‚´í´ë³´ê¸°

Netronì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ì €ì¥í•œ `model.onnx`íŒŒì¼ì„ ì—´ë©´ 380ê°œì˜ ì…ë ¥ ë° ë¶„ë¥˜ìê°€ ë‚˜ì—´ëœ ê°„ë‹¨í•œ ëª¨ë¸ì´ ì‹œê°í™”ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ì´ì œ ìš°ë¦° ì›¹ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤. 

ìš°ë¦¬ê°€ ë§Œë“¤ ì•±ì€ ëƒ‰ì¥ê³ ì˜ ë‚´ìš©ë¬¼ì„ ë³¼ ë•Œ ìœ ìš©í•œ ì•±, ëª¨ë¸ì— ë”°ë¼ ì›í•˜ëŠ” ìš”ë¦¬ë¥¼ ìš”ë¦¬í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¬ë£Œì˜ ì¡°í•©ì„ ì•Œì•„ë‚´ëŠ” ì•±ì´ë‹¤.

### ì¶”ì²œ ì›¹ ì•± êµ¬ì¶•

ì›¹ ì•±ì—ì„œ ì§ì ‘ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ë©´ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ë„ ìˆê³  í•„ìš”í•œ ê²½ìš° ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. `model.onnx` íŒŒì¼ì„ ì €ì¥í•œ ë™ì¼í•œ í´ë”ì— `index.html` íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ì‹œì‘í•˜ë©´ ëœë‹¤.

#### `index.html`


```python
<!DOCTYPE html>
<html>
    <header>
        <title>Cuisine Matcher</title>
    </header>
    <body>
        ...
    </body>
</html>
```

`body`íƒœê·¸ ë‚´ì—ì„œ ì‘ì—…í•´ ì¼ë¶€ êµ¬ì„±ìš”ì†Œë¥¼ ë°˜ì˜í•˜ëŠ” í™•ì¸ë€ ëª©ë¡í‘œì‹œ ë§ˆí¬ì—… ì¶”ê°€

ì²´í¬ë°•ìŠ¤ì— ê°’ì´ ì§€ì •ëœë‹¤.

ë°ì´í„°ì…‹ì— ë”°ë¼ ì¬ë£Œê°€ ë°œê²¬ëœ ì¸ë±ìŠ¤ë¥¼ ë°˜ì˜í•œë‹¤. (Appleì€ ì¸ë±ìŠ¤ê°’ì´ 4 : 0ë¶€í„° ê³„ì‚°ì‹œì‘í•´ì„œ)


```python
<h1>Check your refrigerator. What can you create?</h1>
        <div id="wrapper">
            <div class="boxCont">
                <input type="checkbox" value="4" class="checkbox">
                <label>apple</label>
            </div>
        
            <div class="boxCont">
                <input type="checkbox" value="247" class="checkbox">
                <label>pear</label>
            </div>
        
            <div class="boxCont">
                <input type="checkbox" value="77" class="checkbox">
                <label>cherry</label>
            </div>

            <div class="boxCont">
                <input type="checkbox" value="126" class="checkbox">
                <label>fenugreek</label>
            </div>

            <div class="boxCont">
                <input type="checkbox" value="302" class="checkbox">
                <label>sake</label>
            </div>

            <div class="boxCont">
                <input type="checkbox" value="327" class="checkbox">
                <label>soy sauce</label>
            </div>

            <div class="boxCont">
                <input type="checkbox" value="112" class="checkbox">
                <label>cumin</label>
            </div>
        </div>
        <div style="padding-top:10px">
            <button onClick="startInference()">What kind of cuisine can you make?</button>
        </div> 
```

ì´í›„ ëª¨ë¸ì´ í˜¸ì¶œë˜ëŠ” ë¸”ë¡ì„ ì¶”ê°€í•´ì¤€ë‹¤.


```python
<script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.9.0/dist/ort.min.js"></script> 
```


```python
<script>
    const ingredients = Array(380).fill(0);
    
    const checks = [...document.querySelectorAll('.checkbox')];
    
    checks.forEach(check => {
        check.addEventListener('change', function() {
            // toggle the state of the ingredient
            // based on the checkbox's value (1 or 0)
            ingredients[check.value] = check.checked ? 1 : 0;
        });
    });

    function testCheckboxes() {
        // validate if at least one checkbox is checked
        return checks.some(check => check.checked);
    }

    async function startInference() {

        let atLeastOneChecked = testCheckboxes()

        if (!atLeastOneChecked) {
            alert('Please select at least one ingredient.');
            return;
        }
        try {
            // create a new session and load the model.
            
            const session = await ort.InferenceSession.create('./model.onnx');

            const input = new ort.Tensor(new Float32Array(ingredients), [1, 380]);
            const feeds = { float_input: input };

            // feed inputs and run
            const results = await session.run(feeds);

            // read from results
            alert('You can enjoy ' + results.label.data[0] + ' cuisine today!')

        } catch (e) {
            console.log(`failed to inference ONNX model`);
            console.error(e);
        }
    }
           
</script>
```

ìœ„ì˜ ì½”ë“œëŠ” ....
1. ì²´í¬ë°•ìŠ¤ í™•ì¸ë€ì˜ ì„ íƒ ì—¬ë¶€ì— ë”°ë¼ 380ê°œì˜ ê°€ëŠ¥í•œ ê°’(1ë˜ëŠ”0)ì˜ ë°°ì—´ì„ ìƒì„±í•˜ê³  ì¶”ë¡ ì„ ìœ„í•´ ëª¨ë¸ë¡œ ì „ì†¡í•¨
2. ì²´í¬ë°•ìŠ¤ì˜ ë°°ì—´ê³¼ ì•±ì´ ì‹œì‘ë  ë•Œ í˜¸ì¶œë˜ëŠ” ì¶”ê¸°í™” í•¨ìˆ˜ì—ì„œ ì²´í¬ë°•ìŠ¤ê°€ ì²´í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²• ë§Œë“¬. (ì²´í¬ë°•ìŠ¤ ì„ íƒ ì‹œ ì„ íƒí•œ ì¬ë£Œ ë°˜ì˜í•˜ë„ë¡ ì¬ë£Œ ë°°ì—´ ë³€ê²½)
3. ì²´í¬ë°•ìŠ¤ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” `testCheckboxes()`í•¨ìˆ˜ ë§Œë“¬
4. ë²„íŠ¼ ëˆ„ë¥´ë©´ `startInference()`ê¸°ëŠ¥ ì‚¬ìš©í•˜ê³  ì²´í¬ë°•ìŠ¤ ì²´í¬ì‹œ ì¶”ë¡  ì‹œì‘

---

_ì¶”ë¡  ë£¨í‹´ì— í¬í•¨ë˜ëŠ” ê²ƒ_
- ëª¨ë¸ì˜ ë¹„ë™ê¸°ë¡œë“œ ì„¤ì •
- ëª¨ë¸ì´ ë³´ë‚¼ Tenserêµ¬ì¡° ë§Œë“¤ê¸°
- ëª¨ë¸ í›ˆë ¨ì‹œ ìƒì„±í•œ float_inputì…ë ¥ ë°˜ì˜í•˜ëŠ” í”¼ë“œ ìƒì„±(Netronì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì´ë¦„ì„ í™•ì¸í•  ìˆ˜ ìˆìŒ)
- ì´ 'í”¼ë“œ'ë¥¼ ëª¨ë¸ì— ë³´ë‚´ê³  ì‘ë‹µì„ ê¸°ë‹¤ë¦¼

---

â¤ï¸

ì•ì„œ ë§í–ˆë“¯ ì´ëŠ” [Getting started with classification ](https://github.com/codingalzi/ML-For-Beginners/tree/main/4-Classification/1-Introduction) ë‚´ìš©ì— ëŒ€í•œ í•™ìŠµê³¼ ì •ë¦¬ì— ëŒ€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

ë” ìì„¸í•œ ë‚´ìš©ì´ í•„ìš”í•˜ë‹¤ë©´ ë§í¬ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”.

ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™‚

â¤ï¸
